{"ast":null,"code":"var _jsxFileName = \"/Users/h0270/Documents/code/ai-vedio/create_video/subtitle-search-app/src/App.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport './App.css';\nimport axios from 'axios';\n\n// 子页面组件\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SearchPage = ({\n  API_BASE_URL,\n  query,\n  setQuery,\n  searchResults,\n  setSearchResults,\n  loading,\n  setLoading,\n  apiStatus,\n  error,\n  setError,\n  selectedResult,\n  setSelectedResult,\n  videoUrl,\n  setVideoUrl,\n  isVideoLoading,\n  setIsVideoLoading,\n  handleSearch,\n  handleGenerateClip,\n  formatTime,\n  formatEpisode,\n  highlightText,\n  availableDramas,\n  selectedDramas,\n  setSelectedDramas,\n  formatDramaName\n}) => {\n  // 处理剧集选择变化\n  const handleDramaChange = dramaId => {\n    if (selectedDramas.includes(dramaId)) {\n      // 如果已经选中，则从数组中移除\n      setSelectedDramas(selectedDramas.filter(id => id !== dramaId));\n    } else {\n      // 如果未选中，则添加到数组\n      setSelectedDramas([...selectedDramas, dramaId]);\n    }\n  };\n\n  // 选择/取消选择所有剧集\n  const toggleAllDramas = () => {\n    if (selectedDramas.length === availableDramas.length) {\n      // 如果已选择所有剧集，则取消选择所有\n      setSelectedDramas([]);\n    } else {\n      // 选择所有剧集\n      setSelectedDramas(availableDramas.map(drama => drama.id));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"search-area\",\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSearch,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"drama-selector\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"drama-selector-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"\\u9009\\u62E9\\u5267\\u96C6\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 61,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"toggle-all-button\",\n              onClick: toggleAllDramas,\n              children: selectedDramas.length === availableDramas.length ? '取消全选' : '全选'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 62,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"drama-checkbox-container\",\n            children: availableDramas.map(drama => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"drama-checkbox\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                id: `drama-${drama.id}`,\n                checked: selectedDramas.includes(drama.id),\n                onChange: () => handleDramaChange(drama.id)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 73,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: `drama-${drama.id}`,\n                children: formatDramaName(drama)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 79,\n                columnNumber: 19\n              }, this)]\n            }, drama.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-box\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: query,\n            onChange: e => setQuery(e.target.value),\n            placeholder: \"\\u8F93\\u5165\\u8981\\u641C\\u7D22\\u7684\\u5B57\\u5E55\\u5185\\u5BB9...\",\n            disabled: apiStatus !== 'connected'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: loading || apiStatus !== 'connected' || selectedDramas.length === 0,\n            children: loading ? '搜索中...' : '搜索'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 19\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content-area\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"results-area\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"\\u641C\\u7D22\\u7ED3\\u679C \", searchResults.length > 0 && `(${searchResults.length})`]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loading\",\n          children: \"\\u641C\\u7D22\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u5019...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"results-list\",\n          children: searchResults.map((result, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n            className: selectedResult === result ? 'selected' : '',\n            onClick: () => handleGenerateClip(result),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"result-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"drama-name\",\n                children: formatDramaName({\n                  id: result.drama_id\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"episode\",\n                children: formatEpisode(result.episode)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"time\",\n                children: [formatTime(result.start_seconds), \" - \", formatTime(result.end_seconds)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"subtitle-text\",\n              dangerouslySetInnerHTML: {\n                __html: highlightText(result.text, query)\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"video-area\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\u89C6\\u9891\\u64AD\\u653E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), selectedResult ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-player\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u5267\\u96C6:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 20\n              }, this), \" \", formatDramaName({\n                id: selectedResult.drama_id\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u96C6\\u6570:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 20\n              }, this), \" \", formatEpisode(selectedResult.episode)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u65F6\\u95F4\\u6BB5:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 20\n              }, this), \" \", formatTime(selectedResult.start_seconds), \" - \", formatTime(selectedResult.end_seconds)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u5B57\\u5E55\\u5185\\u5BB9:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 20\n              }, this), \" \", selectedResult.text]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 15\n          }, this), isVideoLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-video\",\n            children: \"\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u5019...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 17\n          }, this) : videoUrl ? /*#__PURE__*/_jsxDEV(\"video\", {\n            controls: true,\n            autoPlay: true,\n            className: \"video-element\",\n            src: videoUrl\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-placeholder\",\n            children: selectedResult ? '准备生成视频片段...' : '请从左侧选择一个搜索结果'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-placeholder\",\n          children: \"\\u8BF7\\u4ECE\\u5DE6\\u4FA7\\u9009\\u62E9\\u4E00\\u4E2A\\u641C\\u7D22\\u7ED3\\u679C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n// 成语接龙游戏组件\n_c = SearchPage;\nconst ChainGamePage = ({\n  API_BASE_URL,\n  apiStatus,\n  formatTime,\n  formatEpisode,\n  availableDramas,\n  formatDramaName\n}) => {\n  _s();\n  const [gameStarted, setGameStarted] = useState(false);\n  const [currentPrompts, setCurrentPrompts] = useState([]);\n  const [loadingPrompts, setLoadingPrompts] = useState(false);\n  const [gameLog, setGameLog] = useState([]);\n  const [currentSentence, setCurrentSentence] = useState(null);\n  const [nextOptions, setNextOptions] = useState([]);\n  const [loadingNextOptions, setLoadingNextOptions] = useState(false);\n  const [gameError, setGameError] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(false);\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [isExportingVideo, setIsExportingVideo] = useState(false);\n  const [clipUrls, setClipUrls] = useState([]);\n  const [isConfirmMode, setIsConfirmMode] = useState(false);\n  const [selectedDramas, setSelectedDramas] = useState(availableDramas ? availableDramas.map(drama => drama.id) : []);\n\n  // 处理剧集选择变化\n  const handleDramaChange = dramaId => {\n    if (selectedDramas.includes(dramaId)) {\n      // 如果已经选中，则从数组中移除\n      setSelectedDramas(selectedDramas.filter(id => id !== dramaId));\n    } else {\n      // 如果未选中，则添加到数组\n      setSelectedDramas([...selectedDramas, dramaId]);\n    }\n  };\n\n  // 选择/取消选择所有剧集\n  const toggleAllDramas = () => {\n    if (selectedDramas.length === availableDramas.length) {\n      // 如果已选择所有剧集，则取消选择所有\n      setSelectedDramas([]);\n    } else {\n      // 选择所有剧集\n      setSelectedDramas(availableDramas.map(drama => drama.id));\n    }\n  };\n\n  // 获取随机提示句子\n  const fetchRandomPrompts = async () => {\n    if (selectedDramas.length === 0) {\n      setGameError('请至少选择一个剧集');\n      return;\n    }\n    setLoadingPrompts(true);\n    setGameError(null);\n    try {\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/random_sentences`, {\n        params: {\n          count: 8,\n          drama_ids: dramaIdsParam\n        }\n      });\n      if (response.data && response.data.results) {\n        setCurrentPrompts(response.data.results);\n      } else {\n        setGameError('获取提示句子失败');\n      }\n    } catch (error) {\n      console.error('获取提示句子错误:', error);\n      setGameError('无法获取提示句子，请确保API服务正常运行');\n    } finally {\n      setLoadingPrompts(false);\n    }\n  };\n\n  // 刷新随机提示\n  const refreshRandomPrompts = () => {\n    if (apiStatus === 'connected' && !loadingPrompts) {\n      fetchRandomPrompts();\n    }\n  };\n\n  // 生成视频片段\n  const generateVideoClip = async subtitle => {\n    setIsVideoLoading(true);\n    setVideoUrl('');\n    setGameError(null);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/generate_clip`, {\n        drama_id: subtitle.drama_id,\n        episode: subtitle.episode,\n        start_time: subtitle.start_seconds,\n        end_time: subtitle.end_seconds,\n        context_seconds: 2\n      });\n      if (response.data && response.data.clip_url) {\n        const clipUrl = `${API_BASE_URL}${response.data.clip_url}`;\n        setVideoUrl(clipUrl);\n        return clipUrl;\n      } else {\n        setGameError('生成视频片段失败');\n        return null;\n      }\n    } catch (error) {\n      console.error('生成视频片段出错:', error);\n      setGameError('视频服务出现错误，请确保视频文件存在且可访问');\n      return null;\n    } finally {\n      setIsVideoLoading(false);\n    }\n  };\n\n  // 选择开始句子\n  const selectStartSentence = prompt => {\n    setSelectedOption(prompt);\n    setIsConfirmMode(true);\n    generateVideoClip(prompt);\n  };\n\n  // 确认选择开始句子\n  const confirmStartSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    setCurrentSentence(sentence);\n    setGameLog([{\n      ...sentence,\n      step: 1,\n      clipUrl: videoUrl\n    }]);\n    setClipUrls([...clipUrls, videoUrl]);\n    setGameStarted(true);\n    fetchNextOptions(sentence.text);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 取消选择\n  const cancelSelection = () => {\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n    setVideoUrl('');\n  };\n\n  // 选择下一个句子\n  const selectNextSentence = option => {\n    setSelectedOption(option);\n    setIsConfirmMode(true);\n    generateVideoClip(option);\n  };\n\n  // 确认选择下一个句子\n  const confirmNextSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    setCurrentSentence(sentence);\n    setGameLog([...gameLog, {\n      ...sentence,\n      step: gameLog.length + 1,\n      clipUrl: videoUrl\n    }]);\n    setClipUrls([...clipUrls, videoUrl]);\n    fetchNextOptions(sentence.text);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 获取下一步选项\n  const fetchNextOptions = async text => {\n    if (!text) return;\n    setLoadingNextOptions(true);\n    setGameError(null);\n    try {\n      // 获取最后一个字，排除语气词\n      let lastChar = getLastValidChar(text);\n      if (!lastChar) {\n        setGameError('无法识别有效的结尾字符');\n        setLoadingNextOptions(false);\n        return;\n      }\n      console.log(`正在查找以\"${lastChar}\"开头的句子...`);\n\n      // 确保有选择的剧集\n      if (selectedDramas.length === 0) {\n        setGameError('请至少选择一个剧集');\n        setLoadingNextOptions(false);\n        return;\n      }\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await fetch(`${API_BASE_URL}/api/search?query=${encodeURIComponent(`^${lastChar}`)}&use_regex=true&drama_ids=${dramaIdsParam}`);\n      if (!response.ok) {\n        throw new Error(`API请求失败: ${response.status}`);\n      }\n      const data = await response.json();\n      if (data && data.results) {\n        console.log(`API返回了 ${data.results.length} 条结果`);\n\n        // 过滤结果，保留3-8个字的句子\n        const filteredResults = data.results.filter(item => {\n          const cleanText = item.text.replace(/[啊呢吗吧呀嘛哦哎嗯呐呵呦诶哈哟]$/, '');\n          return cleanText.length >= 3 && cleanText.length <= 8;\n        });\n        console.log(`过滤后还有 ${filteredResults.length} 条结果`);\n        if (filteredResults.length === 0) {\n          // 如果没有找到结果，尝试不使用正则表达式的精确查询\n          console.log(`尝试使用精确查询搜索以\"${lastChar}\"开头的句子`);\n          const fallbackResponse = await fetch(`${API_BASE_URL}/api/search?query=${encodeURIComponent(lastChar)}&drama_ids=${dramaIdsParam}`);\n          const fallbackData = await fallbackResponse.json();\n          if (fallbackData && fallbackData.results) {\n            console.log(`精确查询返回了 ${fallbackData.results.length} 条结果`);\n            // 手动过滤以lastChar开头的结果\n            const manualFilteredResults = fallbackData.results.filter(item => {\n              return item.text.startsWith(lastChar) && item.text.length >= 3 && item.text.length <= 8;\n            });\n            if (manualFilteredResults.length > 0) {\n              console.log(`手动过滤后找到 ${manualFilteredResults.length} 条结果`);\n              // 随机选择最多8个结果\n              const shuffled = [...manualFilteredResults].sort(() => 0.5 - Math.random());\n              setNextOptions(shuffled.slice(0, 8));\n              setLoadingNextOptions(false);\n              return;\n            }\n          }\n          setGameError(`没有找到以\"${lastChar}\"开头的句子`);\n        } else {\n          // 随机选择最多8个结果\n          const shuffled = [...filteredResults].sort(() => 0.5 - Math.random());\n          setNextOptions(shuffled.slice(0, 8));\n        }\n      } else {\n        setGameError('获取接续句子失败');\n      }\n    } catch (error) {\n      console.error('获取接续句子错误:', error);\n      setGameError(`查询错误: ${error.message}`);\n    } finally {\n      setLoadingNextOptions(false);\n    }\n  };\n\n  // 获取最后一个有效字符（排除语气词）\n  const getLastValidChar = text => {\n    if (!text || text.length === 0) return null;\n\n    // 排除常见语气词\n    const cleanText = text.replace(/[啊呢吗吧呀嘛哦哎嗯呐呵呦诶哈哟]$/, '');\n    return cleanText.length > 0 ? cleanText[cleanText.length - 1] : null;\n  };\n\n  // 刷新下一步选项\n  const refreshNextOptions = () => {\n    if (currentSentence && !loadingNextOptions) {\n      fetchNextOptions(currentSentence.text);\n    }\n  };\n\n  // 回到上一步\n  const goBackOneStep = () => {\n    if (gameLog.length <= 1) {\n      // 只有一步，回到选择开始句子\n      setGameStarted(false);\n      setGameLog([]);\n      setCurrentSentence(null);\n      setNextOptions([]);\n      setClipUrls([]);\n      setVideoUrl('');\n      fetchRandomPrompts();\n    } else {\n      // 移除最后一步\n      const newLog = [...gameLog];\n      newLog.pop();\n      setGameLog(newLog);\n\n      // 更新当前句子和视频\n      const prevSentence = newLog[newLog.length - 1];\n      setCurrentSentence(prevSentence);\n\n      // 更新剪辑URL列表\n      const newClipUrls = [...clipUrls];\n      newClipUrls.pop();\n      setClipUrls(newClipUrls);\n\n      // 重新获取选项\n      fetchNextOptions(prevSentence.text);\n    }\n  };\n\n  // 合并视频并导出\n  const exportMergedVideo = async () => {\n    if (clipUrls.length === 0) return;\n    setIsExportingVideo(true);\n    setGameError(null);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/merge_clips`, {\n        clip_urls: clipUrls\n      });\n      if (response.data && response.data.merged_url) {\n        const mergedVideoUrl = `${API_BASE_URL}${response.data.merged_url}`;\n\n        // 创建下载链接\n        const link = document.createElement('a');\n        link.href = mergedVideoUrl;\n        link.download = '接龙视频.mp4';\n        link.click();\n        console.log('视频合并成功，已触发下载');\n      } else {\n        setGameError('视频合并失败: ' + (response.data.error || '未知错误'));\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('视频合并错误:', error);\n      setGameError('视频合并服务出错: ' + (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || error.message));\n    } finally {\n      setIsExportingVideo(false);\n    }\n  };\n\n  // 开始新游戏\n  const startNewGame = () => {\n    setGameLog([]);\n    fetchRandomPrompts();\n    setGameStarted(false);\n    setCurrentSentence(null);\n    setNextOptions([]);\n    setClipUrls([]);\n    setVideoUrl('');\n    setSelectedOption(null);\n    setIsConfirmMode(false);\n  };\n\n  // 初始加载时获取随机提示\n  useEffect(() => {\n    if (apiStatus === 'connected') {\n      fetchRandomPrompts();\n    }\n  }, [apiStatus]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chain-game-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"drama-selector\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drama-selector-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u9009\\u62E9\\u5267\\u96C6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"toggle-all-button\",\n          onClick: toggleAllDramas,\n          children: selectedDramas.length === availableDramas.length ? '取消全选' : '全选'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 531,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drama-checkbox-container\",\n        children: availableDramas.map(drama => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"drama-checkbox\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            id: `chain-drama-${drama.id}`,\n            checked: selectedDramas.includes(drama.id),\n            onChange: () => handleDramaChange(drama.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 544,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: `chain-drama-${drama.id}`,\n            children: formatDramaName(drama)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 550,\n            columnNumber: 15\n          }, this)]\n        }, drama.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 543,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 541,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 530,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startNewGame,\n        className: \"new-game-btn\",\n        disabled: apiStatus !== 'connected',\n        children: \"\\u65B0\\u6E38\\u620F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 559,\n        columnNumber: 9\n      }, this), gameStarted && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: goBackOneStep,\n        className: \"back-btn\",\n        disabled: gameLog.length === 0,\n        children: \"\\u4E0A\\u4E00\\u6B65\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 11\n      }, this), clipUrls.length > 1 && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: exportMergedVideo,\n        className: \"export-btn\",\n        disabled: isExportingVideo,\n        children: isExportingVideo ? '导出中...' : '导出接龙视频'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 7\n    }, this), gameError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: gameError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 21\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game-candidates\",\n        children: [!gameStarted ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"start-game-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"section-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\u9009\\u62E9\\u5F00\\u59CB\\u53E5\\u5B50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 594,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: refreshRandomPrompts,\n              className: \"refresh-btn\",\n              disabled: loadingPrompts || apiStatus !== 'connected',\n              children: \"\\u6362\\u4E00\\u6279\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 595,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 593,\n            columnNumber: 15\n          }, this), loadingPrompts ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading\",\n            children: \"\\u52A0\\u8F7D\\u63D0\\u793A\\u53E5\\u5B50\\u4E2D...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 605,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"prompts-list\",\n            children: currentPrompts.map((prompt, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              onClick: () => selectStartSentence(prompt),\n              className: selectedOption === prompt ? 'prompt-item selected' : 'prompt-item',\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-text\",\n                children: prompt.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 614,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(prompt.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 616,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(prompt.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 617,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `sentence-type ${analyzeSentenceType(prompt.text)}`,\n                  children: analyzeSentenceType(prompt.text)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 618,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 615,\n                columnNumber: 23\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 609,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 607,\n            columnNumber: 17\n          }, this), currentPrompts.length === 0 && !loadingPrompts && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"empty-prompts\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u6CA1\\u6709\\u53EF\\u7528\\u7684\\u63D0\\u793A\\u53E5\\u5B50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 627,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: refreshRandomPrompts,\n              children: \"\\u91CD\\u65B0\\u83B7\\u53D6\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 628,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 626,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 592,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"current-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\u5F53\\u524D\\u53E5\\u5B50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 635,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"current-sentence\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"current-text\",\n                children: currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 637,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"current-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 639,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 640,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 638,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"next-hint\",\n                children: [\"\\u4E0B\\u4E00\\u53E5\\u9700\\u4EE5\\u300C\", getLastValidChar(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.text), \"\\u300D\\u5B57\\u5F00\\u5934\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 642,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 636,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 634,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"next-options-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"section-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"\\u53EF\\u9009\\u63A5\\u7EED\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 650,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: refreshNextOptions,\n                className: \"refresh-btn\",\n                disabled: loadingNextOptions,\n                children: \"\\u6362\\u4E00\\u6279\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 651,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 649,\n              columnNumber: 17\n            }, this), loadingNextOptions ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loading\",\n              children: \"\\u52A0\\u8F7D\\u63A5\\u7EED\\u53E5\\u5B50\\u4E2D...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 661,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"options-list\",\n              children: nextOptions.map((option, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                onClick: () => selectNextSentence(option),\n                className: selectedOption === option ? 'option-item selected' : 'option-item',\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"option-text\",\n                  children: option.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 670,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"option-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"episode\",\n                    children: formatEpisode(option.episode)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 672,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"time\",\n                    children: formatTime(option.start_seconds)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 673,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `sentence-type ${analyzeSentenceType(option.text)}`,\n                    children: analyzeSentenceType(option.text)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 674,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 671,\n                  columnNumber: 25\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 665,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 663,\n              columnNumber: 19\n            }, this), nextOptions.length === 0 && !loadingNextOptions && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"no-options\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u6CA1\\u6709\\u627E\\u5230\\u5408\\u9002\\u7684\\u63A5\\u7EED\\u53E5\\u5B50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 682,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: startNewGame,\n                children: \"\\u91CD\\u65B0\\u5F00\\u59CB\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 683,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 681,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 648,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"game-log-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u63A5\\u9F99\\u8BB0\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 692,\n            columnNumber: 13\n          }, this), gameLog.length > 0 ? /*#__PURE__*/_jsxDEV(\"ol\", {\n            className: \"game-log-list\",\n            children: gameLog.map((log, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"log-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"log-text\",\n                children: log.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 697,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"log-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(log.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 699,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(log.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 700,\n                  columnNumber: 23\n                }, this), log.clipUrl && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"clip-info\",\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"video-icon\",\n                    children: \"\\uD83C\\uDFAC\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 703,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 702,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 698,\n                columnNumber: 21\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 696,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 694,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"empty-log\",\n            children: \"\\u5C1A\\u672A\\u5F00\\u59CB\\u6E38\\u620F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 711,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 691,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 590,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game-video-preview\",\n        children: [isConfirmMode && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"confirm-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"selected-sentence\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"selected-text\",\n              children: selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 721,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"selected-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"episode\",\n                children: formatEpisode(selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.episode)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 723,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"time\",\n                children: formatTime(selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.start_seconds)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 724,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 722,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 720,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-preview\",\n            children: isVideoLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loading-video\",\n              children: \"\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u5019...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 730,\n              columnNumber: 19\n            }, this) : videoUrl ? /*#__PURE__*/_jsxDEV(\"video\", {\n              controls: true,\n              autoPlay: true,\n              className: \"video-element\",\n              src: videoUrl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 732,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"video-placeholder\",\n              children: \"\\u51C6\\u5907\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 739,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 728,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"confirm-buttons\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"confirm-btn\",\n              onClick: gameStarted ? confirmNextSentence : confirmStartSentence,\n              disabled: isVideoLoading || !videoUrl,\n              children: \"\\u786E\\u8BA4\\u9009\\u62E9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 744,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cancel-btn\",\n              onClick: cancelSelection,\n              children: \"\\u53D6\\u6D88\\u9009\\u62E9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 751,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 743,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 719,\n          columnNumber: 13\n        }, this), !isConfirmMode && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u89C6\\u9891\\u9884\\u89C8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 762,\n            columnNumber: 15\n          }, this), isVideoLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-video\",\n            children: \"\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u5019...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 764,\n            columnNumber: 17\n          }, this) : videoUrl ? /*#__PURE__*/_jsxDEV(\"video\", {\n            controls: true,\n            autoPlay: true,\n            className: \"video-element\",\n            src: videoUrl\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 766,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-placeholder large\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"placeholder-text\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u8BF7\\u4ECE\\u5DE6\\u4FA7\\u9009\\u62E9\\u4E00\\u4E2A\\u53E5\\u5B50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 775,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u9009\\u62E9\\u540E\\u5C06\\u5728\\u6B64\\u5904\\u9884\\u89C8\\u89C6\\u9891\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 776,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 774,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 773,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 761,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 717,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 588,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 529,\n    columnNumber: 5\n  }, this);\n};\n\n// 押韵游戏组件\n_s(ChainGamePage, \"jTGscrXdtt0JB0KTOqT41MaQ5xc=\");\n_c2 = ChainGamePage;\nconst RhymeGamePage = ({\n  API_BASE_URL,\n  apiStatus,\n  formatTime,\n  formatEpisode,\n  availableDramas,\n  formatDramaName\n}) => {\n  _s2();\n  const [gameStarted, setGameStarted] = useState(false);\n  const [currentPrompts, setCurrentPrompts] = useState([]);\n  const [loadingPrompts, setLoadingPrompts] = useState(false);\n  const [gameLog, setGameLog] = useState([]);\n  const [currentSentence, setCurrentSentence] = useState(null);\n  const [nextOptions, setNextOptions] = useState([]);\n  const [loadingNextOptions, setLoadingNextOptions] = useState(false);\n  const [gameError, setGameError] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(false);\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [isExportingVideo, setIsExportingVideo] = useState(false);\n  const [clipUrls, setClipUrls] = useState([]);\n  const [isConfirmMode, setIsConfirmMode] = useState(false);\n  const [selectedDramas, setSelectedDramas] = useState(availableDramas ? availableDramas.map(drama => drama.id) : []);\n\n  // 处理剧集选择变化\n  const handleDramaChange = dramaId => {\n    if (selectedDramas.includes(dramaId)) {\n      // 如果已经选中，则从数组中移除\n      setSelectedDramas(selectedDramas.filter(id => id !== dramaId));\n    } else {\n      // 如果未选中，则添加到数组\n      setSelectedDramas([...selectedDramas, dramaId]);\n    }\n  };\n\n  // 选择/取消选择所有剧集\n  const toggleAllDramas = () => {\n    if (selectedDramas.length === availableDramas.length) {\n      // 如果已选择所有剧集，则取消选择所有\n      setSelectedDramas([]);\n    } else {\n      // 选择所有剧集\n      setSelectedDramas(availableDramas.map(drama => drama.id));\n    }\n  };\n\n  // 获取随机提示句子\n  const fetchRandomPrompts = async () => {\n    if (selectedDramas.length === 0) {\n      setGameError('请至少选择一个剧集');\n      return;\n    }\n    setLoadingPrompts(true);\n    setGameError(null);\n    try {\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/random_sentences`, {\n        params: {\n          count: 8,\n          drama_ids: dramaIdsParam\n        }\n      });\n      if (response.data && response.data.results) {\n        setCurrentPrompts(response.data.results);\n      } else {\n        setGameError('获取提示句子失败');\n      }\n    } catch (error) {\n      console.error('获取提示句子错误:', error);\n      setGameError('无法获取提示句子，请确保API服务正常运行');\n    } finally {\n      setLoadingPrompts(false);\n    }\n  };\n\n  // 刷新随机提示\n  const refreshRandomPrompts = () => {\n    if (apiStatus === 'connected' && !loadingPrompts) {\n      fetchRandomPrompts();\n    }\n  };\n\n  // 生成视频片段\n  const generateVideoClip = async subtitle => {\n    setIsVideoLoading(true);\n    setVideoUrl('');\n    setGameError(null);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/generate_clip`, {\n        drama_id: subtitle.drama_id,\n        episode: subtitle.episode,\n        start_time: subtitle.start_seconds,\n        end_time: subtitle.end_seconds,\n        context_seconds: 2\n      });\n      if (response.data && response.data.clip_url) {\n        const clipUrl = `${API_BASE_URL}${response.data.clip_url}`;\n        setVideoUrl(clipUrl);\n        return clipUrl;\n      } else {\n        setGameError('生成视频片段失败');\n        return null;\n      }\n    } catch (error) {\n      console.error('生成视频片段出错:', error);\n      setGameError('视频服务出现错误，请确保视频文件存在且可访问');\n      return null;\n    } finally {\n      setIsVideoLoading(false);\n    }\n  };\n\n  // 选择开始句子\n  const selectStartSentence = prompt => {\n    setSelectedOption(prompt);\n    setIsConfirmMode(true);\n    generateVideoClip(prompt);\n  };\n\n  // 确认选择开始句子\n  const confirmStartSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    setCurrentSentence(sentence);\n    setGameLog([{\n      ...sentence,\n      step: 1,\n      clipUrl: videoUrl\n    }]);\n    setClipUrls([...clipUrls, videoUrl]);\n    setGameStarted(true);\n    fetchRhymingOptions(sentence.text);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 取消选择\n  const cancelSelection = () => {\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n    setVideoUrl('');\n  };\n\n  // 选择下一个句子\n  const selectNextSentence = option => {\n    setSelectedOption(option);\n    setIsConfirmMode(true);\n    generateVideoClip(option);\n  };\n\n  // 确认选择下一个句子\n  const confirmNextSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    setCurrentSentence(sentence);\n    setGameLog([...gameLog, {\n      ...sentence,\n      step: gameLog.length + 1,\n      clipUrl: videoUrl\n    }]);\n    setClipUrls([...clipUrls, videoUrl]);\n    fetchRhymingOptions(sentence.text);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 获取押韵选项\n  const fetchRhymingOptions = async text => {\n    if (!text) return;\n    setLoadingNextOptions(true);\n    setGameError(null);\n    try {\n      // 获取最后一个字的拼音，用于押韵\n      const lastChar = getLastValidChar(text);\n      if (!lastChar) {\n        setGameError('无法识别有效的结尾字符');\n        setLoadingNextOptions(false);\n        return;\n      }\n\n      // 确保有选择的剧集\n      if (selectedDramas.length === 0) {\n        setGameError('请至少选择一个剧集');\n        setLoadingNextOptions(false);\n        return;\n      }\n      console.log(`正在查找与\"${lastChar}\"押韵的句子...`);\n\n      // 调用押韵API\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/rhyming_sentences`, {\n        params: {\n          text: text,\n          min_length: 3,\n          max_length: 12,\n          limit: 8,\n          drama_ids: dramaIdsParam\n        }\n      });\n      if (response.data && response.data.results) {\n        console.log(`API返回了 ${response.data.results.length} 条押韵结果`);\n        setNextOptions(response.data.results);\n      } else {\n        setGameError('获取押韵句子失败：无结果返回');\n        setNextOptions([]);\n      }\n    } catch (error) {\n      console.error('获取押韵句子错误:', error);\n      setGameError(`查询错误: ${error.message}`);\n      setNextOptions([]);\n    } finally {\n      setLoadingNextOptions(false);\n    }\n  };\n\n  // 获取最后一个有效字符（排除语气词）\n  const getLastValidChar = text => {\n    if (!text || text.length === 0) return null;\n\n    // 排除常见语气词\n    const cleanText = text.replace(/[啊呢吗吧呀嘛哦哎嗯呐呵呦诶哈哟]$/, '');\n    return cleanText.length > 0 ? cleanText[cleanText.length - 1] : null;\n  };\n\n  // 刷新下一步选项\n  const refreshNextOptions = () => {\n    if (currentSentence && !loadingNextOptions) {\n      fetchRhymingOptions(currentSentence.text);\n    }\n  };\n\n  // 回到上一步\n  const goBackOneStep = () => {\n    if (gameLog.length <= 1) {\n      // 只有一步，回到选择开始句子\n      setGameStarted(false);\n      setGameLog([]);\n      setCurrentSentence(null);\n      setNextOptions([]);\n      setClipUrls([]);\n      setVideoUrl('');\n      fetchRandomPrompts();\n    } else {\n      // 移除最后一步\n      const newLog = [...gameLog];\n      newLog.pop();\n      setGameLog(newLog);\n\n      // 更新当前句子和视频\n      const prevSentence = newLog[newLog.length - 1];\n      setCurrentSentence(prevSentence);\n\n      // 更新剪辑URL列表\n      const newClipUrls = [...clipUrls];\n      newClipUrls.pop();\n      setClipUrls(newClipUrls);\n\n      // 重新获取选项\n      fetchRhymingOptions(prevSentence.text);\n    }\n  };\n\n  // 合并视频并导出\n  const exportMergedVideo = async () => {\n    if (clipUrls.length === 0) return;\n    setIsExportingVideo(true);\n    setGameError(null);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/merge_clips`, {\n        clip_urls: clipUrls\n      });\n      if (response.data && response.data.merged_url) {\n        const mergedVideoUrl = `${API_BASE_URL}${response.data.merged_url}`;\n\n        // 创建下载链接\n        const link = document.createElement('a');\n        link.href = mergedVideoUrl;\n        link.download = '押韵视频.mp4';\n        link.click();\n        console.log('视频合并成功，已触发下载');\n      } else {\n        setGameError('视频合并失败: ' + (response.data.error || '未知错误'));\n      }\n    } catch (error) {\n      console.error('视频合并错误:', error);\n      setGameError('视频合并服务出错: ' + error.message);\n    } finally {\n      setIsExportingVideo(false);\n    }\n  };\n\n  // 开始新游戏\n  const startNewGame = () => {\n    setGameLog([]);\n    fetchRandomPrompts();\n    setGameStarted(false);\n    setCurrentSentence(null);\n    setNextOptions([]);\n    setClipUrls([]);\n    setVideoUrl('');\n    setSelectedOption(null);\n    setIsConfirmMode(false);\n  };\n\n  // 初始加载时获取随机提示\n  useEffect(() => {\n    if (apiStatus === 'connected') {\n      fetchRandomPrompts();\n    }\n  }, [apiStatus]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chain-game-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"drama-selector\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drama-selector-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u9009\\u62E9\\u5267\\u96C6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1114,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"toggle-all-button\",\n          onClick: toggleAllDramas,\n          children: selectedDramas.length === availableDramas.length ? '取消全选' : '全选'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1115,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1113,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drama-checkbox-container\",\n        children: availableDramas.map(drama => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"drama-checkbox\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            id: `rhyme-drama-${drama.id}`,\n            checked: selectedDramas.includes(drama.id),\n            onChange: () => handleDramaChange(drama.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1126,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: `rhyme-drama-${drama.id}`,\n            children: formatDramaName(drama)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1132,\n            columnNumber: 15\n          }, this)]\n        }, drama.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1125,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1123,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startNewGame,\n        className: \"new-game-btn\",\n        disabled: apiStatus !== 'connected',\n        children: \"\\u65B0\\u6E38\\u620F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1141,\n        columnNumber: 9\n      }, this), gameLog.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: goBackOneStep,\n          className: \"back-btn\",\n          disabled: isConfirmMode,\n          children: \"\\u4E0A\\u4E00\\u6B65\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1151,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: exportMergedVideo,\n          className: \"export-btn\",\n          disabled: gameLog.length < 2 || isExportingVideo,\n          children: isExportingVideo ? '导出中...' : '导出押韵视频'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1159,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1140,\n      columnNumber: 7\n    }, this), gameError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-error\",\n      children: gameError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1171,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game-candidates\",\n        children: [!gameStarted ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"start-game-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"section-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\u9009\\u62E9\\u5F00\\u59CB\\u53E5\\u5B50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1180,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: refreshRandomPrompts,\n              className: \"refresh-btn\",\n              disabled: loadingPrompts || apiStatus !== 'connected',\n              children: \"\\u6362\\u4E00\\u6279\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1181,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1179,\n            columnNumber: 15\n          }, this), loadingPrompts ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading\",\n            children: \"\\u52A0\\u8F7D\\u63D0\\u793A\\u53E5\\u5B50\\u4E2D...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1191,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"prompts-list\",\n            children: currentPrompts.map((prompt, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              onClick: () => selectStartSentence(prompt),\n              className: selectedOption === prompt ? 'prompt-item selected' : 'prompt-item',\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-text\",\n                children: prompt.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1200,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(prompt.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1202,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(prompt.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1203,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `sentence-type ${analyzeSentenceType(prompt.text)}`,\n                  children: analyzeSentenceType(prompt.text)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1204,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1201,\n                columnNumber: 23\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1195,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1193,\n            columnNumber: 17\n          }, this), currentPrompts.length === 0 && !loadingPrompts && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"empty-prompts\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u6CA1\\u6709\\u53EF\\u7528\\u7684\\u63D0\\u793A\\u53E5\\u5B50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1213,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: refreshRandomPrompts,\n              children: \"\\u91CD\\u65B0\\u83B7\\u53D6\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1214,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1212,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1178,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"current-sentence-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"section-header\",\n              children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"\\u5F53\\u524D\\u53E5\\u5B50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1222,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1221,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"current-sentence\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"sentence-text\",\n                children: currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1226,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"sentence-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1228,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1229,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1227,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"sentence-type-tag\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: analyzeSentenceType(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.text),\n                  children: analyzeSentenceType(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.text)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1232,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1231,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1225,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1220,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"next-options-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"section-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"\\u62BC\\u97F5\\u9009\\u9879\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1239,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: refreshNextOptions,\n                className: \"refresh-btn\",\n                disabled: loadingNextOptions,\n                children: \"\\u6362\\u4E00\\u6279\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1240,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1238,\n              columnNumber: 17\n            }, this), loadingNextOptions ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loading\",\n              children: \"\\u52A0\\u8F7D\\u62BC\\u97F5\\u53E5\\u5B50\\u4E2D...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1250,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"options-list\",\n              children: nextOptions.map((option, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                onClick: () => selectNextSentence(option),\n                className: selectedOption === option ? 'option-item selected' : 'option-item',\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"option-text\",\n                  children: option.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1259,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"option-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"episode\",\n                    children: formatEpisode(option.episode)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1261,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"time\",\n                    children: formatTime(option.start_seconds)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1262,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `sentence-type ${analyzeSentenceType(option.text)}`,\n                    children: analyzeSentenceType(option.text)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1263,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1260,\n                  columnNumber: 25\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1254,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1252,\n              columnNumber: 19\n            }, this), nextOptions.length === 0 && !loadingNextOptions && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"empty-options\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u6CA1\\u6709\\u627E\\u5230\\u5408\\u9002\\u7684\\u62BC\\u97F5\\u53E5\\u5B50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1272,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: startNewGame,\n                children: \"\\u91CD\\u65B0\\u5F00\\u59CB\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1273,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1271,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1237,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"game-log-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u62BC\\u97F5\\u8BB0\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1282,\n            columnNumber: 13\n          }, this), gameLog.length > 0 ? /*#__PURE__*/_jsxDEV(\"ol\", {\n            className: \"game-log-list\",\n            children: gameLog.map((log, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"log-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"log-text\",\n                children: log.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1287,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"log-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(log.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1289,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(log.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1290,\n                  columnNumber: 23\n                }, this), log.clipUrl && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"clip-info\",\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"video-icon\",\n                    children: \"\\uD83C\\uDFAC\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1293,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1292,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1288,\n                columnNumber: 21\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1286,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1284,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"empty-log\",\n            children: \"\\u5C1A\\u672A\\u5F00\\u59CB\\u6E38\\u620F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1301,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1281,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1176,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game-video-preview\",\n        children: [isConfirmMode && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"confirm-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"selected-sentence\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"selected-text\",\n              children: selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1311,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"selected-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"episode\",\n                children: formatEpisode(selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.episode)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1313,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"time\",\n                children: formatTime(selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.start_seconds)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1314,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1312,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1310,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-preview\",\n            children: isVideoLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loading-video\",\n              children: \"\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u5019...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1320,\n              columnNumber: 19\n            }, this) : videoUrl ? /*#__PURE__*/_jsxDEV(\"video\", {\n              controls: true,\n              autoPlay: true,\n              className: \"video-element\",\n              src: videoUrl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1322,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"video-placeholder\",\n              children: \"\\u51C6\\u5907\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1329,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1318,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"confirm-buttons\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"confirm-btn\",\n              onClick: gameStarted ? confirmNextSentence : confirmStartSentence,\n              disabled: isVideoLoading || !videoUrl,\n              children: \"\\u786E\\u8BA4\\u9009\\u62E9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1334,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cancel-btn\",\n              onClick: cancelSelection,\n              children: \"\\u53D6\\u6D88\\u9009\\u62E9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1341,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1333,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1309,\n          columnNumber: 13\n        }, this), !isConfirmMode && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u89C6\\u9891\\u9884\\u89C8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1352,\n            columnNumber: 15\n          }, this), isVideoLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-video\",\n            children: \"\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u5019...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1354,\n            columnNumber: 17\n          }, this) : videoUrl ? /*#__PURE__*/_jsxDEV(\"video\", {\n            controls: true,\n            autoPlay: true,\n            className: \"video-element\",\n            src: videoUrl\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1356,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-placeholder large\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"placeholder-text\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u8BF7\\u4ECE\\u5DE6\\u4FA7\\u9009\\u62E9\\u4E00\\u4E2A\\u53E5\\u5B50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1365,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u9009\\u62E9\\u540E\\u5C06\\u5728\\u6B64\\u5904\\u9884\\u89C8\\u89C6\\u9891\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1366,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1364,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1363,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1351,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1307,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1174,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1111,\n    columnNumber: 5\n  }, this);\n};\n\n// 奇妙对话组件\n_s2(RhymeGamePage, \"jTGscrXdtt0JB0KTOqT41MaQ5xc=\");\n_c3 = RhymeGamePage;\nconst DialogueGamePage = ({\n  API_BASE_URL,\n  apiStatus,\n  formatTime,\n  formatEpisode,\n  availableDramas,\n  formatDramaName\n}) => {\n  _s3();\n  const [gameStarted, setGameStarted] = useState(false);\n  const [currentPrompts, setCurrentPrompts] = useState([]);\n  const [loadingPrompts, setLoadingPrompts] = useState(false);\n  const [gameLog, setGameLog] = useState([]);\n  const [currentSentence, setCurrentSentence] = useState(null);\n  const [nextOptions, setNextOptions] = useState([]);\n  const [loadingNextOptions, setLoadingNextOptions] = useState(false);\n  const [gameError, setGameError] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(false);\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [isExportingVideo, setIsExportingVideo] = useState(false);\n  const [clipUrls, setClipUrls] = useState([]);\n  const [isConfirmMode, setIsConfirmMode] = useState(false);\n  const [selectedDramas, setSelectedDramas] = useState(availableDramas ? availableDramas.map(drama => drama.id) : []);\n\n  // 处理剧集选择变化\n  const handleDramaChange = dramaId => {\n    if (selectedDramas.includes(dramaId)) {\n      // 如果已经选中，则从数组中移除\n      setSelectedDramas(selectedDramas.filter(id => id !== dramaId));\n    } else {\n      // 如果未选中，则添加到数组\n      setSelectedDramas([...selectedDramas, dramaId]);\n    }\n  };\n\n  // 选择/取消选择所有剧集\n  const toggleAllDramas = () => {\n    if (selectedDramas.length === availableDramas.length) {\n      // 如果已选择所有剧集，则取消选择所有\n      setSelectedDramas([]);\n    } else {\n      // 选择所有剧集\n      setSelectedDramas(availableDramas.map(drama => drama.id));\n    }\n  };\n\n  // 获取随机提示句子\n  const fetchRandomPrompts = async () => {\n    if (selectedDramas.length === 0) {\n      setGameError('请至少选择一个剧集');\n      return;\n    }\n    setLoadingPrompts(true);\n    setGameError(null);\n    try {\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/random_sentences`, {\n        params: {\n          count: 8,\n          drama_ids: dramaIdsParam\n        }\n      });\n      if (response.data && response.data.results) {\n        setCurrentPrompts(response.data.results);\n      } else {\n        setGameError('获取提示句子失败');\n      }\n    } catch (error) {\n      console.error('获取提示句子错误:', error);\n      setGameError('无法获取提示句子，请确保API服务正常运行');\n    } finally {\n      setLoadingPrompts(false);\n    }\n  };\n\n  // 刷新随机提示\n  const refreshRandomPrompts = () => {\n    if (apiStatus === 'connected' && !loadingPrompts) {\n      fetchRandomPrompts();\n    }\n  };\n\n  // 生成视频片段\n  const generateVideoClip = async subtitle => {\n    setIsVideoLoading(true);\n    setVideoUrl('');\n    setGameError(null);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/generate_clip`, {\n        drama_id: subtitle.drama_id,\n        episode: subtitle.episode,\n        start_time: subtitle.start_seconds,\n        end_time: subtitle.end_seconds,\n        context_seconds: 2\n      });\n      if (response.data && response.data.clip_url) {\n        const clipUrl = `${API_BASE_URL}${response.data.clip_url}`;\n        setVideoUrl(clipUrl);\n        return clipUrl;\n      } else {\n        setGameError('生成视频片段失败');\n        return null;\n      }\n    } catch (error) {\n      console.error('生成视频片段出错:', error);\n      setGameError('视频服务出现错误，请确保视频文件存在且可访问');\n      return null;\n    } finally {\n      setIsVideoLoading(false);\n    }\n  };\n\n  // 选择开始句子\n  const selectStartSentence = prompt => {\n    setSelectedOption(prompt);\n    setIsConfirmMode(true);\n    generateVideoClip(prompt);\n  };\n\n  // 确认选择开始句子\n  const confirmStartSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    setCurrentSentence(sentence);\n    setGameLog([{\n      ...sentence,\n      step: 1,\n      clipUrl: videoUrl\n    }]);\n    setClipUrls([...clipUrls, videoUrl]);\n    setGameStarted(true);\n    fetchDialogueResponses(sentence);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 取消选择\n  const cancelSelection = () => {\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n    setVideoUrl('');\n  };\n\n  // 选择下一个句子\n  const selectNextSentence = option => {\n    setSelectedOption(option);\n    setIsConfirmMode(true);\n    generateVideoClip(option);\n  };\n\n  // 确认选择下一个句子\n  const confirmNextSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    setCurrentSentence(sentence);\n    setGameLog([...gameLog, {\n      ...sentence,\n      step: gameLog.length + 1,\n      clipUrl: videoUrl\n    }]);\n    setClipUrls([...clipUrls, videoUrl]);\n    fetchDialogueResponses(sentence);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 获取对话回应选项\n  const fetchDialogueResponses = async sentence => {\n    if (!sentence) return;\n    setLoadingNextOptions(true);\n    setGameError(null);\n    try {\n      console.log(`正在查找对\"${sentence.text}\"的有趣回应...`);\n\n      // 确保有选择的剧集\n      if (selectedDramas.length === 0) {\n        setGameError('请至少选择一个剧集');\n        setLoadingNextOptions(false);\n        return;\n      }\n\n      // 调用后端API查询对话回应\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.post(`${API_BASE_URL}/api/dialogue_responses`, {\n        sentence_text: sentence.text,\n        episode: sentence.episode,\n        drama_ids: dramaIdsParam,\n        current_drama_id: sentence.drama_id\n      });\n      if (response.data && response.data.results) {\n        console.log(`API返回了 ${response.data.results.length} 条对话回应`);\n        setNextOptions(response.data.results);\n      } else {\n        setGameError('获取对话回应失败：无结果返回');\n        setNextOptions([]);\n      }\n    } catch (error) {\n      console.error('获取对话回应错误:', error);\n      setGameError(`获取对话回应失败: ${error.message}`);\n      setNextOptions([]);\n    } finally {\n      setLoadingNextOptions(false);\n    }\n  };\n\n  // 获取最后一个有效字符（排除语气词）\n  const getLastValidChar = text => {\n    if (!text || text.length === 0) return null;\n\n    // 排除常见语气词\n    const cleanText = text.replace(/[啊呢吗吧呀嘛哦哎嗯呐呵呦诶哈哟]$/, '');\n    return cleanText.length > 0 ? cleanText[cleanText.length - 1] : null;\n  };\n\n  // 刷新下一步选项\n  const refreshNextOptions = () => {\n    if (currentSentence && !loadingNextOptions) {\n      fetchDialogueResponses(currentSentence);\n    }\n  };\n\n  // 回到上一步\n  const goBackOneStep = () => {\n    if (gameLog.length <= 1) {\n      // 只有一步，回到选择开始句子\n      setGameStarted(false);\n      setGameLog([]);\n      setCurrentSentence(null);\n      setNextOptions([]);\n      setClipUrls([]);\n      setVideoUrl('');\n      fetchRandomPrompts();\n    } else {\n      // 移除最后一步\n      const newLog = [...gameLog];\n      newLog.pop();\n      setGameLog(newLog);\n\n      // 更新当前句子和视频\n      const prevSentence = newLog[newLog.length - 1];\n      setCurrentSentence(prevSentence);\n\n      // 更新剪辑URL列表\n      const newClipUrls = [...clipUrls];\n      newClipUrls.pop();\n      setClipUrls(newClipUrls);\n\n      // 重新获取选项\n      fetchDialogueResponses(prevSentence);\n    }\n  };\n\n  // 合并视频并导出\n  const exportMergedVideo = async () => {\n    if (clipUrls.length === 0) return;\n    setIsExportingVideo(true);\n    setGameError(null);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/merge_clips`, {\n        clip_urls: clipUrls\n      });\n      if (response.data && response.data.merged_url) {\n        const mergedVideoUrl = `${API_BASE_URL}${response.data.merged_url}`;\n\n        // 创建下载链接\n        const link = document.createElement('a');\n        link.href = mergedVideoUrl;\n        link.download = '奇妙对话视频.mp4';\n        link.click();\n        console.log('视频合并成功，已触发下载');\n      } else {\n        setGameError('视频合并失败: ' + (response.data.error || '未知错误'));\n      }\n    } catch (error) {\n      console.error('视频合并错误:', error);\n      setGameError('视频合并服务出错: ' + error.message);\n    } finally {\n      setIsExportingVideo(false);\n    }\n  };\n\n  // 开始新游戏\n  const startNewGame = () => {\n    setGameLog([]);\n    fetchRandomPrompts();\n    setGameStarted(false);\n    setCurrentSentence(null);\n    setNextOptions([]);\n    setClipUrls([]);\n    setVideoUrl('');\n    setSelectedOption(null);\n    setIsConfirmMode(false);\n  };\n\n  // 初始加载时获取随机提示\n  useEffect(() => {\n    if (apiStatus === 'connected') {\n      fetchRandomPrompts();\n    }\n  }, [apiStatus]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chain-game-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"drama-selector\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drama-selector-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u9009\\u62E9\\u5267\\u96C6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1692,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"toggle-all-button\",\n          onClick: toggleAllDramas,\n          children: selectedDramas.length === availableDramas.length ? '取消全选' : '全选'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1693,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1691,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drama-checkbox-container\",\n        children: availableDramas.map(drama => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"drama-checkbox\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            id: `dialogue-drama-${drama.id}`,\n            checked: selectedDramas.includes(drama.id),\n            onChange: () => handleDramaChange(drama.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1704,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: `dialogue-drama-${drama.id}`,\n            children: formatDramaName(drama)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1710,\n            columnNumber: 15\n          }, this)]\n        }, drama.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1703,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1701,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1690,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startNewGame,\n        className: \"new-game-btn\",\n        disabled: apiStatus !== 'connected',\n        children: \"\\u65B0\\u6E38\\u620F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1719,\n        columnNumber: 9\n      }, this), gameLog.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: goBackOneStep,\n          className: \"back-btn\",\n          disabled: isConfirmMode,\n          children: \"\\u4E0A\\u4E00\\u6B65\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1729,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: exportMergedVideo,\n          className: \"export-btn\",\n          disabled: gameLog.length < 2 || isExportingVideo,\n          children: isExportingVideo ? '导出中...' : '导出对话视频'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1737,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1718,\n      columnNumber: 7\n    }, this), gameError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-error\",\n      children: gameError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1749,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game-candidates\",\n        children: [!gameStarted ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"start-game-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"section-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\u9009\\u62E9\\u5F00\\u59CB\\u53E5\\u5B50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1758,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: refreshRandomPrompts,\n              className: \"refresh-btn\",\n              disabled: loadingPrompts || apiStatus !== 'connected',\n              children: \"\\u6362\\u4E00\\u6279\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1759,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1757,\n            columnNumber: 15\n          }, this), loadingPrompts ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading\",\n            children: \"\\u52A0\\u8F7D\\u63D0\\u793A\\u53E5\\u5B50\\u4E2D...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1769,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"prompts-list\",\n            children: currentPrompts.map((prompt, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              onClick: () => selectStartSentence(prompt),\n              className: selectedOption === prompt ? 'prompt-item selected' : 'prompt-item',\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-text\",\n                children: prompt.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1778,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(prompt.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1780,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(prompt.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1781,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `sentence-type ${analyzeSentenceType(prompt.text)}`,\n                  children: analyzeSentenceType(prompt.text)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1782,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1779,\n                columnNumber: 23\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1773,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1771,\n            columnNumber: 17\n          }, this), currentPrompts.length === 0 && !loadingPrompts && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"empty-prompts\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u6CA1\\u6709\\u53EF\\u7528\\u7684\\u63D0\\u793A\\u53E5\\u5B50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1791,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: refreshRandomPrompts,\n              children: \"\\u91CD\\u65B0\\u83B7\\u53D6\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1792,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1790,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1756,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"current-sentence-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"section-header\",\n              children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"\\u5F53\\u524D\\u53E5\\u5B50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1800,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1799,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"current-sentence\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"sentence-text\",\n                children: currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1804,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"sentence-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1806,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1807,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1805,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"sentence-type-tag\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: analyzeSentenceType(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.text),\n                  children: analyzeSentenceType(currentSentence === null || currentSentence === void 0 ? void 0 : currentSentence.text)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1810,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1809,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1803,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1798,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"next-options-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"section-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"\\u6709\\u8DA3\\u56DE\\u5E94\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1817,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: refreshNextOptions,\n                className: \"refresh-btn\",\n                disabled: loadingNextOptions,\n                children: \"\\u6362\\u4E00\\u6279\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1818,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1816,\n              columnNumber: 17\n            }, this), loadingNextOptions ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loading\",\n              children: \"\\u67E5\\u627E\\u6709\\u8DA3\\u56DE\\u5E94\\u4E2D...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1828,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"options-list\",\n              children: nextOptions.map((option, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                onClick: () => selectNextSentence(option),\n                className: selectedOption === option ? 'option-item selected' : 'option-item',\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"option-text\",\n                  children: option.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1837,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"option-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"episode\",\n                    children: formatEpisode(option.episode)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1839,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"time\",\n                    children: formatTime(option.start_seconds)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1840,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `sentence-type ${analyzeSentenceType(option.text)}`,\n                    children: analyzeSentenceType(option.text)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1841,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1838,\n                  columnNumber: 25\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1832,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1830,\n              columnNumber: 19\n            }, this), nextOptions.length === 0 && !loadingNextOptions && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"empty-options\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u6CA1\\u6709\\u627E\\u5230\\u5408\\u9002\\u7684\\u56DE\\u5E94\\u53E5\\u5B50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1850,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: startNewGame,\n                children: \"\\u91CD\\u65B0\\u5F00\\u59CB\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1851,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1849,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1815,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"game-log-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u5BF9\\u8BDD\\u8BB0\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1860,\n            columnNumber: 13\n          }, this), gameLog.length > 0 ? /*#__PURE__*/_jsxDEV(\"ol\", {\n            className: \"game-log-list\",\n            children: gameLog.map((log, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"log-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"log-text\",\n                children: log.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1865,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"log-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"episode\",\n                  children: formatEpisode(log.episode)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1867,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"time\",\n                  children: formatTime(log.start_seconds)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1868,\n                  columnNumber: 23\n                }, this), log.clipUrl && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"clip-info\",\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"video-icon\",\n                    children: \"\\uD83C\\uDFAC\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1871,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1870,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1866,\n                columnNumber: 21\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1864,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1862,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"empty-log\",\n            children: \"\\u5C1A\\u672A\\u5F00\\u59CB\\u5BF9\\u8BDD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1879,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1859,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1754,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game-video-preview\",\n        children: [isConfirmMode && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"confirm-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"selected-sentence\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"selected-text\",\n              children: selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1889,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"selected-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"episode\",\n                children: formatEpisode(selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.episode)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1891,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"time\",\n                children: formatTime(selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.start_seconds)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1892,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1890,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1888,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-preview\",\n            children: isVideoLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loading-video\",\n              children: \"\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u5019...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1898,\n              columnNumber: 19\n            }, this) : videoUrl ? /*#__PURE__*/_jsxDEV(\"video\", {\n              controls: true,\n              autoPlay: true,\n              className: \"video-element\",\n              src: videoUrl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1900,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"video-placeholder\",\n              children: \"\\u51C6\\u5907\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1907,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1896,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"confirm-buttons\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"confirm-btn\",\n              onClick: gameStarted ? confirmNextSentence : confirmStartSentence,\n              disabled: isVideoLoading || !videoUrl,\n              children: \"\\u786E\\u8BA4\\u9009\\u62E9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1912,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cancel-btn\",\n              onClick: cancelSelection,\n              children: \"\\u53D6\\u6D88\\u9009\\u62E9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1919,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1911,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1887,\n          columnNumber: 13\n        }, this), !isConfirmMode && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u89C6\\u9891\\u9884\\u89C8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1930,\n            columnNumber: 15\n          }, this), isVideoLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-video\",\n            children: \"\\u751F\\u6210\\u89C6\\u9891\\u7247\\u6BB5\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u5019...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1932,\n            columnNumber: 17\n          }, this) : videoUrl ? /*#__PURE__*/_jsxDEV(\"video\", {\n            controls: true,\n            autoPlay: true,\n            className: \"video-element\",\n            src: videoUrl\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1934,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-placeholder large\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"placeholder-text\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u8BF7\\u4ECE\\u5DE6\\u4FA7\\u9009\\u62E9\\u4E00\\u4E2A\\u53E5\\u5B50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1943,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u9009\\u62E9\\u540E\\u5C06\\u5728\\u6B64\\u5904\\u9884\\u89C8\\u89C6\\u9891\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1944,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1942,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1941,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1929,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1885,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1752,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1689,\n    columnNumber: 5\n  }, this);\n};\n\n// 分析句子类型 - 全局辅助函数\n_s3(DialogueGamePage, \"jTGscrXdtt0JB0KTOqT41MaQ5xc=\");\n_c4 = DialogueGamePage;\nconst analyzeSentenceType = text => {\n  if (!text) return '普通句';\n\n  // 判断是否为问句\n  if (text.includes('?') || text.includes('？') || text.includes('吗') || text.includes('呢')) {\n    return '疑问句';\n  }\n\n  // 判断是否为命令句\n  const commandWords = ['去', '来', '给我', '快', '立刻', '马上', '传'];\n  if (commandWords.some(word => text.includes(word))) {\n    return '命令句';\n  }\n\n  // 判断情感色彩\n  const positiveWords = ['好', '愿意', '可以', '是', '对', '喜欢', '爱', '高兴'];\n  const negativeWords = ['不', '没', '别', '莫', '拒绝', '难过', '恨', '讨厌'];\n  if (positiveWords.some(word => text.includes(word))) {\n    return '积极句';\n  }\n  if (negativeWords.some(word => text.includes(word))) {\n    return '消极句';\n  }\n  return '普通句';\n};\nfunction App() {\n  _s4();\n  const API_BASE_URL = 'http://localhost:8089';\n\n  // 搜索页面状态\n  const [query, setQuery] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [apiStatus, setApiStatus] = useState('unknown');\n  const [error, setError] = useState(null);\n  const [selectedResult, setSelectedResult] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(false);\n  const [currentPage, setCurrentPage] = useState('search');\n\n  // 剧集相关状态\n  const [availableDramas, setAvailableDramas] = useState([]);\n  const [selectedDramas, setSelectedDramas] = useState([]);\n  const [dramaStats, setDramaStats] = useState({});\n  useEffect(() => {\n    checkApiStatus();\n  }, []);\n\n  // 获取API状态并加载可用剧集\n  const checkApiStatus = async () => {\n    try {\n      const response = await axios.get(`${API_BASE_URL}/api/status`);\n      if (response.data && response.data.status === 'ok') {\n        setApiStatus('connected');\n\n        // 保存剧集信息\n        if (response.data.dramas) {\n          setAvailableDramas(response.data.dramas);\n          // 默认选择所有可用剧集\n          setSelectedDramas(response.data.dramas.map(drama => drama.id));\n        }\n\n        // 保存剧集统计信息\n        if (response.data.drama_stats) {\n          setDramaStats(response.data.drama_stats);\n        }\n      } else {\n        setApiStatus('error');\n        setError('API服务状态异常');\n      }\n    } catch (error) {\n      console.error('API状态检查错误:', error);\n      setApiStatus('disconnected');\n      setError('无法连接到API服务，请确保服务器已启动');\n    }\n  };\n  const handleSearch = async e => {\n    if (e) e.preventDefault();\n    if (apiStatus !== 'connected') return;\n    if (!query.trim()) {\n      setError('请输入搜索内容');\n      return;\n    }\n    if (selectedDramas.length === 0) {\n      setError('请至少选择一个剧集');\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    setSearchResults([]);\n    setSelectedResult(null);\n    setVideoUrl('');\n    try {\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/search`, {\n        params: {\n          query: query.trim(),\n          drama_ids: dramaIdsParam,\n          case_sensitive: false\n        }\n      });\n      if (response.data && response.data.results) {\n        console.log(\"搜索结果:\", response.data.results);\n        setSearchResults(response.data.results);\n        if (response.data.results.length === 0) {\n          setError(`未找到匹配\"${query}\"的结果`);\n        }\n      } else {\n        setError('未获取到有效的搜索结果');\n      }\n    } catch (error) {\n      console.error('搜索错误:', error);\n      setError('搜索过程中出现错误，请重试');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleGenerateClip = async result => {\n    if (isVideoLoading) return;\n    setSelectedResult(result);\n    setIsVideoLoading(true);\n    setVideoUrl('');\n    setError(null);\n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/generate_clip`, {\n        drama_id: result.drama_id,\n        episode: result.episode,\n        start_time: result.start_seconds,\n        end_time: result.end_seconds,\n        context_seconds: 2\n      });\n      if (response.data && response.data.clip_url) {\n        const url = `${API_BASE_URL}${response.data.clip_url}`;\n        setVideoUrl(url);\n      } else {\n        setError('无法生成视频片段');\n      }\n    } catch (error) {\n      console.error('生成视频片段失败:', error);\n      setError('请求失败，请检查网络连接');\n    } finally {\n      setIsVideoLoading(false);\n    }\n  };\n  const formatTime = seconds => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n  const formatEpisode = episode => {\n    // 从集数名称中提取数字\n    const match = episode.match(/\\d+/);\n    if (match) {\n      return `第${match[0]}集`;\n    }\n    return episode;\n  };\n  const formatDramaName = drama => {\n    // 根据drama_id获取剧名\n    if (!drama || !drama.id) return '未知剧集';\n\n    // 如果传入的是完整drama对象，则直接返回名称\n    if (drama.name) return drama.name;\n\n    // 否则在availableDramas中查找\n    const foundDrama = availableDramas.find(d => d.id === drama.id);\n    return foundDrama ? foundDrama.name : drama.id;\n  };\n  const highlightText = (text, query) => {\n    if (!query || !text) return text;\n\n    // 简单的字符串替换，为匹配的文本添加高亮标签\n    const escapedQuery = query.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    const regex = new RegExp(escapedQuery, 'gi');\n    return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`);\n  };\n  const switchPage = page => {\n    setCurrentPage(page);\n    setError(null);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"App-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u5B57\\u5E55\\u641C\\u7D22\\u7CFB\\u7EDF\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"api-status\",\n        children: [\"API\\u670D\\u52A1\\u72B6\\u6001:\", apiStatus === 'connected' ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-connected\",\n          children: \"\\u5DF2\\u8FDE\\u63A5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2163,\n          columnNumber: 13\n        }, this) : apiStatus === 'disconnected' ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-disconnected\",\n          children: \"\\u672A\\u8FDE\\u63A5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2165,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-checking\",\n          children: \"\\u68C0\\u67E5\\u4E2D...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2167,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2160,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"nav\", {\n        className: \"main-nav\",\n        children: /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            className: currentPage === 'search' ? 'active' : '',\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => switchPage('search'),\n              children: \"\\u5B57\\u5E55\\u641C\\u7D22\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2174,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2173,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: currentPage === 'chain-game' ? 'active' : '',\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => switchPage('chain-game'),\n              children: \"\\u5B57\\u5E55\\u63A5\\u9F99\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2177,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2176,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: currentPage === 'rhyme-game' ? 'active' : '',\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => switchPage('rhyme-game'),\n              children: \"\\u5B57\\u5E55\\u62BC\\u97F5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2180,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2179,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: currentPage === 'dialogue-game' ? 'active' : '',\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => switchPage('dialogue-game'),\n              children: \"\\u5947\\u5999\\u5BF9\\u8BDD\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2183,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2182,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2172,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2171,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2157,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"App-main\",\n      children: [currentPage === 'search' && /*#__PURE__*/_jsxDEV(SearchPage, {\n        API_BASE_URL: API_BASE_URL,\n        query: query,\n        setQuery: setQuery,\n        searchResults: searchResults,\n        setSearchResults: setSearchResults,\n        loading: loading,\n        setLoading: setLoading,\n        apiStatus: apiStatus,\n        error: error,\n        setError: setError,\n        selectedResult: selectedResult,\n        setSelectedResult: setSelectedResult,\n        videoUrl: videoUrl,\n        setVideoUrl: setVideoUrl,\n        isVideoLoading: isVideoLoading,\n        setIsVideoLoading: setIsVideoLoading,\n        handleSearch: handleSearch,\n        handleGenerateClip: handleGenerateClip,\n        formatTime: formatTime,\n        formatEpisode: formatEpisode,\n        highlightText: highlightText,\n        availableDramas: availableDramas,\n        selectedDramas: selectedDramas,\n        setSelectedDramas: setSelectedDramas,\n        formatDramaName: formatDramaName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2191,\n        columnNumber: 11\n      }, this), currentPage === 'chain-game' && /*#__PURE__*/_jsxDEV(ChainGamePage, {\n        API_BASE_URL: API_BASE_URL,\n        apiStatus: apiStatus,\n        formatTime: formatTime,\n        formatEpisode: formatEpisode,\n        availableDramas: availableDramas,\n        formatDramaName: formatDramaName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2221,\n        columnNumber: 11\n      }, this), currentPage === 'rhyme-game' && /*#__PURE__*/_jsxDEV(RhymeGamePage, {\n        API_BASE_URL: API_BASE_URL,\n        apiStatus: apiStatus,\n        formatTime: formatTime,\n        formatEpisode: formatEpisode,\n        availableDramas: availableDramas,\n        formatDramaName: formatDramaName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2232,\n        columnNumber: 11\n      }, this), currentPage === 'dialogue-game' && /*#__PURE__*/_jsxDEV(DialogueGamePage, {\n        API_BASE_URL: API_BASE_URL,\n        apiStatus: apiStatus,\n        formatTime: formatTime,\n        formatEpisode: formatEpisode,\n        availableDramas: availableDramas,\n        formatDramaName: formatDramaName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2243,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2189,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      className: \"App-footer\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u5B57\\u5E55\\u641C\\u7D22\\u7CFB\\u7EDF \\xA9 2023\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2255,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2254,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 2156,\n    columnNumber: 5\n  }, this);\n}\n_s4(App, \"YHhfkhktu3GjT1YKE5b3+6Q9BPg=\");\n_c5 = App;\nexport default App;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"SearchPage\");\n$RefreshReg$(_c2, \"ChainGamePage\");\n$RefreshReg$(_c3, \"RhymeGamePage\");\n$RefreshReg$(_c4, \"DialogueGamePage\");\n$RefreshReg$(_c5, \"App\");","map":{"version":3,"names":["React","useState","useEffect","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","SearchPage","API_BASE_URL","query","setQuery","searchResults","setSearchResults","loading","setLoading","apiStatus","error","setError","selectedResult","setSelectedResult","videoUrl","setVideoUrl","isVideoLoading","setIsVideoLoading","handleSearch","handleGenerateClip","formatTime","formatEpisode","highlightText","availableDramas","selectedDramas","setSelectedDramas","formatDramaName","handleDramaChange","dramaId","includes","filter","id","toggleAllDramas","length","map","drama","children","className","onSubmit","fileName","_jsxFileName","lineNumber","columnNumber","type","onClick","checked","onChange","htmlFor","value","e","target","placeholder","disabled","result","index","drama_id","episode","start_seconds","end_seconds","dangerouslySetInnerHTML","__html","text","controls","autoPlay","src","_c","ChainGamePage","_s","gameStarted","setGameStarted","currentPrompts","setCurrentPrompts","loadingPrompts","setLoadingPrompts","gameLog","setGameLog","currentSentence","setCurrentSentence","nextOptions","setNextOptions","loadingNextOptions","setLoadingNextOptions","gameError","setGameError","selectedOption","setSelectedOption","isExportingVideo","setIsExportingVideo","clipUrls","setClipUrls","isConfirmMode","setIsConfirmMode","fetchRandomPrompts","dramaIdsParam","join","response","get","params","count","drama_ids","data","results","console","refreshRandomPrompts","generateVideoClip","subtitle","post","start_time","end_time","context_seconds","clip_url","clipUrl","selectStartSentence","prompt","confirmStartSentence","sentence","step","fetchNextOptions","cancelSelection","selectNextSentence","option","confirmNextSentence","lastChar","getLastValidChar","log","fetch","encodeURIComponent","ok","Error","status","json","filteredResults","item","cleanText","replace","fallbackResponse","fallbackData","manualFilteredResults","startsWith","shuffled","sort","Math","random","slice","message","refreshNextOptions","goBackOneStep","newLog","pop","prevSentence","newClipUrls","exportMergedVideo","clip_urls","merged_url","mergedVideoUrl","link","document","createElement","href","download","click","_error$response","_error$response$data","startNewGame","analyzeSentenceType","_c2","RhymeGamePage","_s2","fetchRhymingOptions","min_length","max_length","limit","_c3","DialogueGamePage","_s3","fetchDialogueResponses","sentence_text","current_drama_id","_c4","commandWords","some","word","positiveWords","negativeWords","App","_s4","setApiStatus","currentPage","setCurrentPage","setAvailableDramas","dramaStats","setDramaStats","checkApiStatus","dramas","drama_stats","preventDefault","trim","case_sensitive","url","seconds","mins","floor","secs","toString","padStart","match","name","foundDrama","find","d","escapedQuery","regex","RegExp","switchPage","page","_c5","$RefreshReg$"],"sources":["/Users/h0270/Documents/code/ai-vedio/create_video/subtitle-search-app/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './App.css';\nimport axios from 'axios';\n\n// 子页面组件\nconst SearchPage = ({ \n  API_BASE_URL, \n  query, \n  setQuery, \n  searchResults,\n  setSearchResults,\n  loading,\n  setLoading,\n  apiStatus,\n  error,\n  setError,\n  selectedResult,\n  setSelectedResult,\n  videoUrl,\n  setVideoUrl,\n  isVideoLoading,\n  setIsVideoLoading,\n  handleSearch,\n  handleGenerateClip,\n  formatTime,\n  formatEpisode,\n  highlightText,\n  availableDramas,\n  selectedDramas,\n  setSelectedDramas,\n  formatDramaName\n}) => {\n  // 处理剧集选择变化\n  const handleDramaChange = (dramaId) => {\n    if (selectedDramas.includes(dramaId)) {\n      // 如果已经选中，则从数组中移除\n      setSelectedDramas(selectedDramas.filter(id => id !== dramaId));\n    } else {\n      // 如果未选中，则添加到数组\n      setSelectedDramas([...selectedDramas, dramaId]);\n    }\n  };\n\n  // 选择/取消选择所有剧集\n  const toggleAllDramas = () => {\n    if (selectedDramas.length === availableDramas.length) {\n      // 如果已选择所有剧集，则取消选择所有\n      setSelectedDramas([]);\n    } else {\n      // 选择所有剧集\n      setSelectedDramas(availableDramas.map(drama => drama.id));\n    }\n  };\n\n  return (\n    <>\n      <section className=\"search-area\">\n        <form onSubmit={handleSearch}>\n          <div className=\"drama-selector\">\n            <div className=\"drama-selector-header\">\n              <h3>选择剧集</h3>\n              <button \n                type=\"button\" \n                className=\"toggle-all-button\"\n                onClick={toggleAllDramas}\n              >\n                {selectedDramas.length === availableDramas.length ? '取消全选' : '全选'}\n              </button>\n            </div>\n            <div className=\"drama-checkbox-container\">\n              {availableDramas.map(drama => (\n                <div className=\"drama-checkbox\" key={drama.id}>\n                  <input\n                    type=\"checkbox\"\n                    id={`drama-${drama.id}`}\n                    checked={selectedDramas.includes(drama.id)}\n                    onChange={() => handleDramaChange(drama.id)}\n                  />\n                  <label htmlFor={`drama-${drama.id}`}>\n                    {formatDramaName(drama)}\n                  </label>\n                </div>\n              ))}\n            </div>\n          </div>\n          <div className=\"search-box\">\n            <input\n              type=\"text\"\n              value={query}\n              onChange={(e) => setQuery(e.target.value)}\n              placeholder=\"输入要搜索的字幕内容...\"\n              disabled={apiStatus !== 'connected'}\n            />\n            <button \n              type=\"submit\" \n              disabled={loading || apiStatus !== 'connected' || selectedDramas.length === 0}\n            >\n              {loading ? '搜索中...' : '搜索'}\n            </button>\n          </div>\n        </form>\n\n        {error && <div className=\"error-message\">{error}</div>}\n      </section>\n\n      <div className=\"content-area\">\n        <section className=\"results-area\">\n          <h2>搜索结果 {searchResults.length > 0 && `(${searchResults.length})`}</h2>\n          \n          {loading ? (\n            <div className=\"loading\">搜索中，请稍候...</div>\n          ) : (\n            <ul className=\"results-list\">\n              {searchResults.map((result, index) => (\n                <li \n                  key={index} \n                  className={selectedResult === result ? 'selected' : ''}\n                  onClick={() => handleGenerateClip(result)}\n                >\n                  <div className=\"result-header\">\n                    <span className=\"drama-name\">{formatDramaName({id: result.drama_id})}</span>\n                    <span className=\"episode\">{formatEpisode(result.episode)}</span>\n                    <span className=\"time\">{formatTime(result.start_seconds)} - {formatTime(result.end_seconds)}</span>\n                  </div>\n                  <div \n                    className=\"subtitle-text\"\n                    dangerouslySetInnerHTML={{__html: highlightText(result.text, query)}}\n                  />\n                </li>\n              ))}\n            </ul>\n          )}\n        </section>\n\n        <section className=\"video-area\">\n          <h2>视频播放</h2>\n          {selectedResult ? (\n            <div className=\"video-player\">\n              <div className=\"video-info\">\n                <p><strong>剧集:</strong> {formatDramaName({id: selectedResult.drama_id})}</p>\n                <p><strong>集数:</strong> {formatEpisode(selectedResult.episode)}</p>\n                <p><strong>时间段:</strong> {formatTime(selectedResult.start_seconds)} - {formatTime(selectedResult.end_seconds)}</p>\n                <p><strong>字幕内容:</strong> {selectedResult.text}</p>\n              </div>\n              \n              {isVideoLoading ? (\n                <div className=\"loading-video\">生成视频片段中，请稍候...</div>\n              ) : videoUrl ? (\n                <video \n                  controls \n                  autoPlay \n                  className=\"video-element\"\n                  src={videoUrl}\n                />\n              ) : (\n                <div className=\"video-placeholder\">\n                  {selectedResult ? '准备生成视频片段...' : '请从左侧选择一个搜索结果'}\n                </div>\n              )}\n            </div>\n          ) : (\n            <div className=\"video-placeholder\">\n              请从左侧选择一个搜索结果\n            </div>\n          )}\n        </section>\n      </div>\n    </>\n  );\n};\n\n// 成语接龙游戏组件\nconst ChainGamePage = ({ \n  API_BASE_URL, \n  apiStatus,\n  formatTime,\n  formatEpisode,\n  availableDramas,\n  formatDramaName\n}) => {\n  const [gameStarted, setGameStarted] = useState(false);\n  const [currentPrompts, setCurrentPrompts] = useState([]);\n  const [loadingPrompts, setLoadingPrompts] = useState(false);\n  const [gameLog, setGameLog] = useState([]);\n  const [currentSentence, setCurrentSentence] = useState(null);\n  const [nextOptions, setNextOptions] = useState([]);\n  const [loadingNextOptions, setLoadingNextOptions] = useState(false);\n  const [gameError, setGameError] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(false);\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [isExportingVideo, setIsExportingVideo] = useState(false);\n  const [clipUrls, setClipUrls] = useState([]);\n  const [isConfirmMode, setIsConfirmMode] = useState(false);\n  const [selectedDramas, setSelectedDramas] = useState(\n    availableDramas ? availableDramas.map(drama => drama.id) : []\n  );\n\n  // 处理剧集选择变化\n  const handleDramaChange = (dramaId) => {\n    if (selectedDramas.includes(dramaId)) {\n      // 如果已经选中，则从数组中移除\n      setSelectedDramas(selectedDramas.filter(id => id !== dramaId));\n    } else {\n      // 如果未选中，则添加到数组\n      setSelectedDramas([...selectedDramas, dramaId]);\n    }\n  };\n\n  // 选择/取消选择所有剧集\n  const toggleAllDramas = () => {\n    if (selectedDramas.length === availableDramas.length) {\n      // 如果已选择所有剧集，则取消选择所有\n      setSelectedDramas([]);\n    } else {\n      // 选择所有剧集\n      setSelectedDramas(availableDramas.map(drama => drama.id));\n    }\n  };\n\n  // 获取随机提示句子\n  const fetchRandomPrompts = async () => {\n    if (selectedDramas.length === 0) {\n      setGameError('请至少选择一个剧集');\n      return;\n    }\n    \n    setLoadingPrompts(true);\n    setGameError(null);\n    \n    try {\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/random_sentences`, {\n        params: { \n          count: 8,\n          drama_ids: dramaIdsParam\n        }\n      });\n      \n      if (response.data && response.data.results) {\n        setCurrentPrompts(response.data.results);\n      } else {\n        setGameError('获取提示句子失败');\n      }\n    } catch (error) {\n      console.error('获取提示句子错误:', error);\n      setGameError('无法获取提示句子，请确保API服务正常运行');\n    } finally {\n      setLoadingPrompts(false);\n    }\n  };\n\n  // 刷新随机提示\n  const refreshRandomPrompts = () => {\n    if (apiStatus === 'connected' && !loadingPrompts) {\n      fetchRandomPrompts();\n    }\n  };\n\n  // 生成视频片段\n  const generateVideoClip = async (subtitle) => {\n    setIsVideoLoading(true);\n    setVideoUrl('');\n    setGameError(null);\n    \n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/generate_clip`, {\n        drama_id: subtitle.drama_id,\n        episode: subtitle.episode,\n        start_time: subtitle.start_seconds,\n        end_time: subtitle.end_seconds,\n        context_seconds: 2\n      });\n\n      if (response.data && response.data.clip_url) {\n        const clipUrl = `${API_BASE_URL}${response.data.clip_url}`;\n        setVideoUrl(clipUrl);\n        return clipUrl;\n      } else {\n        setGameError('生成视频片段失败');\n        return null;\n      }\n    } catch (error) {\n      console.error('生成视频片段出错:', error);\n      setGameError('视频服务出现错误，请确保视频文件存在且可访问');\n      return null;\n    } finally {\n      setIsVideoLoading(false);\n    }\n  };\n\n  // 选择开始句子\n  const selectStartSentence = (prompt) => {\n    setSelectedOption(prompt);\n    setIsConfirmMode(true);\n    generateVideoClip(prompt);\n  };\n\n  // 确认选择开始句子\n  const confirmStartSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    \n    setCurrentSentence(sentence);\n    setGameLog([{...sentence, step: 1, clipUrl: videoUrl}]);\n    setClipUrls([...clipUrls, videoUrl]);\n    setGameStarted(true);\n    fetchNextOptions(sentence.text);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 取消选择\n  const cancelSelection = () => {\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n    setVideoUrl('');\n  };\n  \n  // 选择下一个句子\n  const selectNextSentence = (option) => {\n    setSelectedOption(option);\n    setIsConfirmMode(true);\n    generateVideoClip(option);\n  };\n\n  // 确认选择下一个句子\n  const confirmNextSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    \n    setCurrentSentence(sentence);\n    setGameLog([...gameLog, {...sentence, step: gameLog.length + 1, clipUrl: videoUrl}]);\n    setClipUrls([...clipUrls, videoUrl]);\n    fetchNextOptions(sentence.text);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 获取下一步选项\n  const fetchNextOptions = async (text) => {\n    if (!text) return;\n    \n    setLoadingNextOptions(true);\n    setGameError(null);\n    \n    try {\n      // 获取最后一个字，排除语气词\n      let lastChar = getLastValidChar(text);\n      \n      if (!lastChar) {\n        setGameError('无法识别有效的结尾字符');\n        setLoadingNextOptions(false);\n        return;\n      }\n      \n      console.log(`正在查找以\"${lastChar}\"开头的句子...`);\n      \n      // 确保有选择的剧集\n      if (selectedDramas.length === 0) {\n        setGameError('请至少选择一个剧集');\n        setLoadingNextOptions(false);\n        return;\n      }\n      \n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await fetch(`${API_BASE_URL}/api/search?query=${encodeURIComponent(`^${lastChar}`)}&use_regex=true&drama_ids=${dramaIdsParam}`);\n      \n      if (!response.ok) {\n        throw new Error(`API请求失败: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      \n      if (data && data.results) {\n        console.log(`API返回了 ${data.results.length} 条结果`);\n        \n        // 过滤结果，保留3-8个字的句子\n        const filteredResults = data.results.filter(item => {\n          const cleanText = item.text.replace(/[啊呢吗吧呀嘛哦哎嗯呐呵呦诶哈哟]$/, '');\n          return cleanText.length >= 3 && cleanText.length <= 8;\n        });\n        \n        console.log(`过滤后还有 ${filteredResults.length} 条结果`);\n        \n        if (filteredResults.length === 0) {\n          // 如果没有找到结果，尝试不使用正则表达式的精确查询\n          console.log(`尝试使用精确查询搜索以\"${lastChar}\"开头的句子`);\n          const fallbackResponse = await fetch(`${API_BASE_URL}/api/search?query=${encodeURIComponent(lastChar)}&drama_ids=${dramaIdsParam}`);\n          const fallbackData = await fallbackResponse.json();\n          \n          if (fallbackData && fallbackData.results) {\n            console.log(`精确查询返回了 ${fallbackData.results.length} 条结果`);\n            // 手动过滤以lastChar开头的结果\n            const manualFilteredResults = fallbackData.results.filter(item => {\n              return item.text.startsWith(lastChar) && \n                     item.text.length >= 3 && \n                     item.text.length <= 8;\n            });\n            \n            if (manualFilteredResults.length > 0) {\n              console.log(`手动过滤后找到 ${manualFilteredResults.length} 条结果`);\n              // 随机选择最多8个结果\n              const shuffled = [...manualFilteredResults].sort(() => 0.5 - Math.random());\n              setNextOptions(shuffled.slice(0, 8));\n              setLoadingNextOptions(false);\n              return;\n            }\n          }\n          \n          setGameError(`没有找到以\"${lastChar}\"开头的句子`);\n        } else {\n          // 随机选择最多8个结果\n          const shuffled = [...filteredResults].sort(() => 0.5 - Math.random());\n          setNextOptions(shuffled.slice(0, 8));\n        }\n      } else {\n        setGameError('获取接续句子失败');\n      }\n    } catch (error) {\n      console.error('获取接续句子错误:', error);\n      setGameError(`查询错误: ${error.message}`);\n    } finally {\n      setLoadingNextOptions(false);\n    }\n  };\n\n  // 获取最后一个有效字符（排除语气词）\n  const getLastValidChar = (text) => {\n    if (!text || text.length === 0) return null;\n    \n    // 排除常见语气词\n    const cleanText = text.replace(/[啊呢吗吧呀嘛哦哎嗯呐呵呦诶哈哟]$/, '');\n    return cleanText.length > 0 ? cleanText[cleanText.length - 1] : null;\n  };\n\n  // 刷新下一步选项\n  const refreshNextOptions = () => {\n    if (currentSentence && !loadingNextOptions) {\n      fetchNextOptions(currentSentence.text);\n    }\n  };\n\n  // 回到上一步\n  const goBackOneStep = () => {\n    if (gameLog.length <= 1) {\n      // 只有一步，回到选择开始句子\n      setGameStarted(false);\n      setGameLog([]);\n      setCurrentSentence(null);\n      setNextOptions([]);\n      setClipUrls([]);\n      setVideoUrl('');\n      fetchRandomPrompts();\n    } else {\n      // 移除最后一步\n      const newLog = [...gameLog];\n      newLog.pop();\n      setGameLog(newLog);\n      \n      // 更新当前句子和视频\n      const prevSentence = newLog[newLog.length - 1];\n      setCurrentSentence(prevSentence);\n      \n      // 更新剪辑URL列表\n      const newClipUrls = [...clipUrls];\n      newClipUrls.pop();\n      setClipUrls(newClipUrls);\n      \n      // 重新获取选项\n      fetchNextOptions(prevSentence.text);\n    }\n  };\n\n  // 合并视频并导出\n  const exportMergedVideo = async () => {\n    if (clipUrls.length === 0) return;\n    \n    setIsExportingVideo(true);\n    setGameError(null);\n    \n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/merge_clips`, {\n        clip_urls: clipUrls\n      });\n      \n      if (response.data && response.data.merged_url) {\n        const mergedVideoUrl = `${API_BASE_URL}${response.data.merged_url}`;\n        \n        // 创建下载链接\n        const link = document.createElement('a');\n        link.href = mergedVideoUrl;\n        link.download = '接龙视频.mp4';\n        link.click();\n        \n        console.log('视频合并成功，已触发下载');\n      } else {\n        setGameError('视频合并失败: ' + (response.data.error || '未知错误'));\n      }\n    } catch (error) {\n      console.error('视频合并错误:', error);\n      setGameError('视频合并服务出错: ' + (error.response?.data?.error || error.message));\n    } finally {\n      setIsExportingVideo(false);\n    }\n  };\n\n  // 开始新游戏\n  const startNewGame = () => {\n    setGameLog([]);\n    fetchRandomPrompts();\n    setGameStarted(false);\n    setCurrentSentence(null);\n    setNextOptions([]);\n    setClipUrls([]);\n    setVideoUrl('');\n    setSelectedOption(null);\n    setIsConfirmMode(false);\n  };\n\n  // 初始加载时获取随机提示\n  useEffect(() => {\n    if (apiStatus === 'connected') {\n      fetchRandomPrompts();\n    }\n  }, [apiStatus]);\n\n  return (\n    <div className=\"chain-game-container\">\n      <div className=\"drama-selector\">\n        <div className=\"drama-selector-header\">\n          <h3>选择剧集</h3>\n          <button \n            type=\"button\" \n            className=\"toggle-all-button\"\n            onClick={toggleAllDramas}\n          >\n            {selectedDramas.length === availableDramas.length ? '取消全选' : '全选'}\n          </button>\n        </div>\n        <div className=\"drama-checkbox-container\">\n          {availableDramas.map(drama => (\n            <div className=\"drama-checkbox\" key={drama.id}>\n              <input\n                type=\"checkbox\"\n                id={`chain-drama-${drama.id}`}\n                checked={selectedDramas.includes(drama.id)}\n                onChange={() => handleDramaChange(drama.id)}\n              />\n              <label htmlFor={`chain-drama-${drama.id}`}>\n                {formatDramaName(drama)}\n              </label>\n            </div>\n          ))}\n        </div>\n      </div>\n      \n      <div className=\"game-controls\">\n        <button \n          onClick={startNewGame}\n          className=\"new-game-btn\"\n          disabled={apiStatus !== 'connected'}\n        >\n          新游戏\n        </button>\n        {gameStarted && (\n          <button \n            onClick={goBackOneStep}\n            className=\"back-btn\"\n            disabled={gameLog.length === 0}\n          >\n            上一步\n          </button>\n        )}\n        {clipUrls.length > 1 && (\n          <button\n            onClick={exportMergedVideo}\n            className=\"export-btn\"\n            disabled={isExportingVideo}\n          >\n            {isExportingVideo ? '导出中...' : '导出接龙视频'}\n          </button>\n        )}\n      </div>\n      \n      {gameError && <div className=\"error-message\">{gameError}</div>}\n      \n      <div className=\"game-content\">\n        {/* 左侧：候选词区域 */}\n        <div className=\"game-candidates\">\n          {!gameStarted ? (\n            <div className=\"start-game-section\">\n              <div className=\"section-header\">\n                <h2>选择开始句子</h2>\n                <button \n                  onClick={refreshRandomPrompts}\n                  className=\"refresh-btn\"\n                  disabled={loadingPrompts || apiStatus !== 'connected'}\n                >\n                  换一批\n                </button>\n              </div>\n              \n              {loadingPrompts ? (\n                <div className=\"loading\">加载提示句子中...</div>\n              ) : (\n                <ul className=\"prompts-list\">\n                  {currentPrompts.map((prompt, index) => (\n                    <li \n                      key={index} \n                      onClick={() => selectStartSentence(prompt)}\n                      className={selectedOption === prompt ? 'prompt-item selected' : 'prompt-item'}\n                    >\n                      <div className=\"prompt-text\">{prompt.text}</div>\n                      <div className=\"prompt-info\">\n                        <span className=\"episode\">{formatEpisode(prompt.episode)}</span>\n                        <span className=\"time\">{formatTime(prompt.start_seconds)}</span>\n                        <span className={`sentence-type ${analyzeSentenceType(prompt.text)}`}>{analyzeSentenceType(prompt.text)}</span>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              )}\n              \n              {currentPrompts.length === 0 && !loadingPrompts && (\n                <div className=\"empty-prompts\">\n                  <p>没有可用的提示句子</p>\n                  <button onClick={refreshRandomPrompts}>重新获取</button>\n                </div>\n              )}\n            </div>\n          ) : (\n            <>\n              <div className=\"current-section\">\n                <h2>当前句子</h2>\n                <div className=\"current-sentence\">\n                  <div className=\"current-text\">{currentSentence?.text}</div>\n                  <div className=\"current-info\">\n                    <span className=\"episode\">{formatEpisode(currentSentence?.episode)}</span>\n                    <span className=\"time\">{formatTime(currentSentence?.start_seconds)}</span>\n                  </div>\n                  <div className=\"next-hint\">\n                    下一句需以「{getLastValidChar(currentSentence?.text)}」字开头\n                  </div>\n                </div>\n              </div>\n                \n              <div className=\"next-options-section\">\n                <div className=\"section-header\">\n                  <h2>可选接续</h2>\n                  <button \n                    onClick={refreshNextOptions}\n                    className=\"refresh-btn\"\n                    disabled={loadingNextOptions}\n                  >\n                    换一批\n                  </button>\n                </div>\n                \n                {loadingNextOptions ? (\n                  <div className=\"loading\">加载接续句子中...</div>\n                ) : (\n                  <ul className=\"options-list\">\n                    {nextOptions.map((option, index) => (\n                      <li \n                        key={index}\n                        onClick={() => selectNextSentence(option)}\n                        className={selectedOption === option ? 'option-item selected' : 'option-item'}\n                      >\n                        <div className=\"option-text\">{option.text}</div>\n                        <div className=\"option-info\">\n                          <span className=\"episode\">{formatEpisode(option.episode)}</span>\n                          <span className=\"time\">{formatTime(option.start_seconds)}</span>\n                          <span className={`sentence-type ${analyzeSentenceType(option.text)}`}>{analyzeSentenceType(option.text)}</span>\n                        </div>\n                      </li>\n                    ))}\n                  </ul>\n                )}\n                {nextOptions.length === 0 && !loadingNextOptions && (\n                  <div className=\"no-options\">\n                    <p>没有找到合适的接续句子</p>\n                    <button onClick={startNewGame}>重新开始</button>\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n\n          {/* 接龙记录 */}\n          <div className=\"game-log-section\">\n            <h2>接龙记录</h2>\n            {gameLog.length > 0 ? (\n              <ol className=\"game-log-list\">\n                {gameLog.map((log, index) => (\n                  <li key={index} className=\"log-item\">\n                    <div className=\"log-text\">{log.text}</div>\n                    <div className=\"log-info\">\n                      <span className=\"episode\">{formatEpisode(log.episode)}</span>\n                      <span className=\"time\">{formatTime(log.start_seconds)}</span>\n                      {log.clipUrl && (\n                        <span className=\"clip-info\">\n                          <i className=\"video-icon\">🎬</i>\n                        </span>\n                      )}\n                    </div>\n                  </li>\n                ))}\n              </ol>\n            ) : (\n              <div className=\"empty-log\">尚未开始游戏</div>\n            )}\n          </div>\n        </div>\n\n        {/* 右侧：视频预览区域 */}\n        <div className=\"game-video-preview\">\n          {isConfirmMode && (\n            <div className=\"confirm-section\">\n              <div className=\"selected-sentence\">\n                <div className=\"selected-text\">{selectedOption?.text}</div>\n                <div className=\"selected-info\">\n                  <span className=\"episode\">{formatEpisode(selectedOption?.episode)}</span>\n                  <span className=\"time\">{formatTime(selectedOption?.start_seconds)}</span>\n                </div>\n              </div>\n              \n              <div className=\"video-preview\">\n                {isVideoLoading ? (\n                  <div className=\"loading-video\">生成视频片段中，请稍候...</div>\n                ) : videoUrl ? (\n                  <video \n                    controls \n                    autoPlay \n                    className=\"video-element\"\n                    src={videoUrl}\n                  />\n                ) : (\n                  <div className=\"video-placeholder\">准备生成视频片段...</div>\n                )}\n              </div>\n              \n              <div className=\"confirm-buttons\">\n                <button \n                  className=\"confirm-btn\"\n                  onClick={gameStarted ? confirmNextSentence : confirmStartSentence}\n                  disabled={isVideoLoading || !videoUrl}\n                >\n                  确认选择\n                </button>\n                <button \n                  className=\"cancel-btn\"\n                  onClick={cancelSelection}\n                >\n                  取消选择\n                </button>\n              </div>\n            </div>\n          )}\n          {!isConfirmMode && (\n            <div className=\"video-section\">\n              <h2>视频预览</h2>\n              {isVideoLoading ? (\n                <div className=\"loading-video\">生成视频片段中，请稍候...</div>\n              ) : videoUrl ? (\n                <video \n                  controls \n                  autoPlay \n                  className=\"video-element\"\n                  src={videoUrl}\n                />\n              ) : (\n                <div className=\"video-placeholder large\">\n                  <div className=\"placeholder-text\">\n                    <p>请从左侧选择一个句子</p>\n                    <p>选择后将在此处预览视频</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// 押韵游戏组件\nconst RhymeGamePage = ({ \n  API_BASE_URL, \n  apiStatus,\n  formatTime,\n  formatEpisode,\n  availableDramas,\n  formatDramaName\n}) => {\n  const [gameStarted, setGameStarted] = useState(false);\n  const [currentPrompts, setCurrentPrompts] = useState([]);\n  const [loadingPrompts, setLoadingPrompts] = useState(false);\n  const [gameLog, setGameLog] = useState([]);\n  const [currentSentence, setCurrentSentence] = useState(null);\n  const [nextOptions, setNextOptions] = useState([]);\n  const [loadingNextOptions, setLoadingNextOptions] = useState(false);\n  const [gameError, setGameError] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(false);\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [isExportingVideo, setIsExportingVideo] = useState(false);\n  const [clipUrls, setClipUrls] = useState([]);\n  const [isConfirmMode, setIsConfirmMode] = useState(false);\n  const [selectedDramas, setSelectedDramas] = useState(\n    availableDramas ? availableDramas.map(drama => drama.id) : []\n  );\n\n  // 处理剧集选择变化\n  const handleDramaChange = (dramaId) => {\n    if (selectedDramas.includes(dramaId)) {\n      // 如果已经选中，则从数组中移除\n      setSelectedDramas(selectedDramas.filter(id => id !== dramaId));\n    } else {\n      // 如果未选中，则添加到数组\n      setSelectedDramas([...selectedDramas, dramaId]);\n    }\n  };\n\n  // 选择/取消选择所有剧集\n  const toggleAllDramas = () => {\n    if (selectedDramas.length === availableDramas.length) {\n      // 如果已选择所有剧集，则取消选择所有\n      setSelectedDramas([]);\n    } else {\n      // 选择所有剧集\n      setSelectedDramas(availableDramas.map(drama => drama.id));\n    }\n  };\n\n  // 获取随机提示句子\n  const fetchRandomPrompts = async () => {\n    if (selectedDramas.length === 0) {\n      setGameError('请至少选择一个剧集');\n      return;\n    }\n    \n    setLoadingPrompts(true);\n    setGameError(null);\n    \n    try {\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/random_sentences`, {\n        params: { \n          count: 8,\n          drama_ids: dramaIdsParam\n        }\n      });\n      \n      if (response.data && response.data.results) {\n        setCurrentPrompts(response.data.results);\n      } else {\n        setGameError('获取提示句子失败');\n      }\n    } catch (error) {\n      console.error('获取提示句子错误:', error);\n      setGameError('无法获取提示句子，请确保API服务正常运行');\n    } finally {\n      setLoadingPrompts(false);\n    }\n  };\n\n  // 刷新随机提示\n  const refreshRandomPrompts = () => {\n    if (apiStatus === 'connected' && !loadingPrompts) {\n      fetchRandomPrompts();\n    }\n  };\n\n  // 生成视频片段\n  const generateVideoClip = async (subtitle) => {\n    setIsVideoLoading(true);\n    setVideoUrl('');\n    setGameError(null);\n    \n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/generate_clip`, {\n        drama_id: subtitle.drama_id,\n        episode: subtitle.episode,\n        start_time: subtitle.start_seconds,\n        end_time: subtitle.end_seconds,\n        context_seconds: 2\n      });\n\n      if (response.data && response.data.clip_url) {\n        const clipUrl = `${API_BASE_URL}${response.data.clip_url}`;\n        setVideoUrl(clipUrl);\n        return clipUrl;\n      } else {\n        setGameError('生成视频片段失败');\n        return null;\n      }\n    } catch (error) {\n      console.error('生成视频片段出错:', error);\n      setGameError('视频服务出现错误，请确保视频文件存在且可访问');\n      return null;\n    } finally {\n      setIsVideoLoading(false);\n    }\n  };\n\n  // 选择开始句子\n  const selectStartSentence = (prompt) => {\n    setSelectedOption(prompt);\n    setIsConfirmMode(true);\n    generateVideoClip(prompt);\n  };\n\n  // 确认选择开始句子\n  const confirmStartSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    \n    setCurrentSentence(sentence);\n    setGameLog([{...sentence, step: 1, clipUrl: videoUrl}]);\n    setClipUrls([...clipUrls, videoUrl]);\n    setGameStarted(true);\n    fetchRhymingOptions(sentence.text);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 取消选择\n  const cancelSelection = () => {\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n    setVideoUrl('');\n  };\n  \n  // 选择下一个句子\n  const selectNextSentence = (option) => {\n    setSelectedOption(option);\n    setIsConfirmMode(true);\n    generateVideoClip(option);\n  };\n\n  // 确认选择下一个句子\n  const confirmNextSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    \n    setCurrentSentence(sentence);\n    setGameLog([...gameLog, {...sentence, step: gameLog.length + 1, clipUrl: videoUrl}]);\n    setClipUrls([...clipUrls, videoUrl]);\n    fetchRhymingOptions(sentence.text);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 获取押韵选项\n  const fetchRhymingOptions = async (text) => {\n    if (!text) return;\n    \n    setLoadingNextOptions(true);\n    setGameError(null);\n    \n    try {\n      // 获取最后一个字的拼音，用于押韵\n      const lastChar = getLastValidChar(text);\n      \n      if (!lastChar) {\n        setGameError('无法识别有效的结尾字符');\n        setLoadingNextOptions(false);\n        return;\n      }\n      \n      // 确保有选择的剧集\n      if (selectedDramas.length === 0) {\n        setGameError('请至少选择一个剧集');\n        setLoadingNextOptions(false);\n        return;\n      }\n      \n      console.log(`正在查找与\"${lastChar}\"押韵的句子...`);\n      \n      // 调用押韵API\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/rhyming_sentences`, {\n        params: {\n          text: text,\n          min_length: 3,\n          max_length: 12,\n          limit: 8,\n          drama_ids: dramaIdsParam\n        }\n      });\n      \n      if (response.data && response.data.results) {\n        console.log(`API返回了 ${response.data.results.length} 条押韵结果`);\n        setNextOptions(response.data.results);\n      } else {\n        setGameError('获取押韵句子失败：无结果返回');\n        setNextOptions([]);\n      }\n    } catch (error) {\n      console.error('获取押韵句子错误:', error);\n      setGameError(`查询错误: ${error.message}`);\n      setNextOptions([]);\n    } finally {\n      setLoadingNextOptions(false);\n    }\n  };\n\n  // 获取最后一个有效字符（排除语气词）\n  const getLastValidChar = (text) => {\n    if (!text || text.length === 0) return null;\n    \n    // 排除常见语气词\n    const cleanText = text.replace(/[啊呢吗吧呀嘛哦哎嗯呐呵呦诶哈哟]$/, '');\n    return cleanText.length > 0 ? cleanText[cleanText.length - 1] : null;\n  };\n\n  // 刷新下一步选项\n  const refreshNextOptions = () => {\n    if (currentSentence && !loadingNextOptions) {\n      fetchRhymingOptions(currentSentence.text);\n    }\n  };\n\n  // 回到上一步\n  const goBackOneStep = () => {\n    if (gameLog.length <= 1) {\n      // 只有一步，回到选择开始句子\n      setGameStarted(false);\n      setGameLog([]);\n      setCurrentSentence(null);\n      setNextOptions([]);\n      setClipUrls([]);\n      setVideoUrl('');\n      fetchRandomPrompts();\n    } else {\n      // 移除最后一步\n      const newLog = [...gameLog];\n      newLog.pop();\n      setGameLog(newLog);\n      \n      // 更新当前句子和视频\n      const prevSentence = newLog[newLog.length - 1];\n      setCurrentSentence(prevSentence);\n      \n      // 更新剪辑URL列表\n      const newClipUrls = [...clipUrls];\n      newClipUrls.pop();\n      setClipUrls(newClipUrls);\n      \n      // 重新获取选项\n      fetchRhymingOptions(prevSentence.text);\n    }\n  };\n\n  // 合并视频并导出\n  const exportMergedVideo = async () => {\n    if (clipUrls.length === 0) return;\n    \n    setIsExportingVideo(true);\n    setGameError(null);\n    \n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/merge_clips`, {\n        clip_urls: clipUrls\n      });\n      \n      if (response.data && response.data.merged_url) {\n        const mergedVideoUrl = `${API_BASE_URL}${response.data.merged_url}`;\n        \n        // 创建下载链接\n        const link = document.createElement('a');\n        link.href = mergedVideoUrl;\n        link.download = '押韵视频.mp4';\n        link.click();\n        \n        console.log('视频合并成功，已触发下载');\n      } else {\n        setGameError('视频合并失败: ' + (response.data.error || '未知错误'));\n      }\n    } catch (error) {\n      console.error('视频合并错误:', error);\n      setGameError('视频合并服务出错: ' + error.message);\n    } finally {\n      setIsExportingVideo(false);\n    }\n  };\n\n  // 开始新游戏\n  const startNewGame = () => {\n    setGameLog([]);\n    fetchRandomPrompts();\n    setGameStarted(false);\n    setCurrentSentence(null);\n    setNextOptions([]);\n    setClipUrls([]);\n    setVideoUrl('');\n    setSelectedOption(null);\n    setIsConfirmMode(false);\n  };\n\n  // 初始加载时获取随机提示\n  useEffect(() => {\n    if (apiStatus === 'connected') {\n      fetchRandomPrompts();\n    }\n  }, [apiStatus]);\n\n  return (\n    <div className=\"chain-game-container\">\n      <div className=\"drama-selector\">\n        <div className=\"drama-selector-header\">\n          <h3>选择剧集</h3>\n          <button \n            type=\"button\" \n            className=\"toggle-all-button\"\n            onClick={toggleAllDramas}\n          >\n            {selectedDramas.length === availableDramas.length ? '取消全选' : '全选'}\n          </button>\n        </div>\n        <div className=\"drama-checkbox-container\">\n          {availableDramas.map(drama => (\n            <div className=\"drama-checkbox\" key={drama.id}>\n              <input\n                type=\"checkbox\"\n                id={`rhyme-drama-${drama.id}`}\n                checked={selectedDramas.includes(drama.id)}\n                onChange={() => handleDramaChange(drama.id)}\n              />\n              <label htmlFor={`rhyme-drama-${drama.id}`}>\n                {formatDramaName(drama)}\n              </label>\n            </div>\n          ))}\n        </div>\n      </div>\n      \n      <div className=\"game-controls\">\n        <button \n          onClick={startNewGame}\n          className=\"new-game-btn\"\n          disabled={apiStatus !== 'connected'}\n        >\n          新游戏\n        </button>\n        \n        {gameLog.length > 0 && (\n          <>\n            <button \n              onClick={goBackOneStep}\n              className=\"back-btn\"\n              disabled={isConfirmMode}\n            >\n              上一步\n            </button>\n            \n            <button \n              onClick={exportMergedVideo}\n              className=\"export-btn\"\n              disabled={gameLog.length < 2 || isExportingVideo}\n            >\n              {isExportingVideo ? '导出中...' : '导出押韵视频'}\n            </button>\n          </>\n        )}\n      </div>\n      \n      {gameError && (\n        <div className=\"game-error\">{gameError}</div>\n      )}\n      \n      <div className=\"game-content\">\n        {/* 左侧：候选词区域 */}\n        <div className=\"game-candidates\">\n          {!gameStarted ? (\n            <div className=\"start-game-section\">\n              <div className=\"section-header\">\n                <h2>选择开始句子</h2>\n                <button \n                  onClick={refreshRandomPrompts}\n                  className=\"refresh-btn\"\n                  disabled={loadingPrompts || apiStatus !== 'connected'}\n                >\n                  换一批\n                </button>\n              </div>\n              \n              {loadingPrompts ? (\n                <div className=\"loading\">加载提示句子中...</div>\n              ) : (\n                <ul className=\"prompts-list\">\n                  {currentPrompts.map((prompt, index) => (\n                    <li \n                      key={index} \n                      onClick={() => selectStartSentence(prompt)}\n                      className={selectedOption === prompt ? 'prompt-item selected' : 'prompt-item'}\n                    >\n                      <div className=\"prompt-text\">{prompt.text}</div>\n                      <div className=\"prompt-info\">\n                        <span className=\"episode\">{formatEpisode(prompt.episode)}</span>\n                        <span className=\"time\">{formatTime(prompt.start_seconds)}</span>\n                        <span className={`sentence-type ${analyzeSentenceType(prompt.text)}`}>{analyzeSentenceType(prompt.text)}</span>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              )}\n              \n              {currentPrompts.length === 0 && !loadingPrompts && (\n                <div className=\"empty-prompts\">\n                  <p>没有可用的提示句子</p>\n                  <button onClick={refreshRandomPrompts}>重新获取</button>\n                </div>\n              )}\n            </div>\n          ) : (\n            <>\n              <div className=\"current-sentence-section\">\n                <div className=\"section-header\">\n                  <h2>当前句子</h2>\n                </div>\n                \n                <div className=\"current-sentence\">\n                  <div className=\"sentence-text\">{currentSentence?.text}</div>\n                  <div className=\"sentence-info\">\n                    <span className=\"episode\">{formatEpisode(currentSentence?.episode)}</span>\n                    <span className=\"time\">{formatTime(currentSentence?.start_seconds)}</span>\n                  </div>\n                  <div className=\"sentence-type-tag\">\n                    <span className={analyzeSentenceType(currentSentence?.text)}>{analyzeSentenceType(currentSentence?.text)}</span>\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"next-options-section\">\n                <div className=\"section-header\">\n                  <h2>押韵选项</h2>\n                  <button \n                    onClick={refreshNextOptions}\n                    className=\"refresh-btn\"\n                    disabled={loadingNextOptions}\n                  >\n                    换一批\n                  </button>\n                </div>\n                \n                {loadingNextOptions ? (\n                  <div className=\"loading\">加载押韵句子中...</div>\n                ) : (\n                  <ul className=\"options-list\">\n                    {nextOptions.map((option, index) => (\n                      <li \n                        key={index}\n                        onClick={() => selectNextSentence(option)}\n                        className={selectedOption === option ? 'option-item selected' : 'option-item'}\n                      >\n                        <div className=\"option-text\">{option.text}</div>\n                        <div className=\"option-info\">\n                          <span className=\"episode\">{formatEpisode(option.episode)}</span>\n                          <span className=\"time\">{formatTime(option.start_seconds)}</span>\n                          <span className={`sentence-type ${analyzeSentenceType(option.text)}`}>{analyzeSentenceType(option.text)}</span>\n                        </div>\n                      </li>\n                    ))}\n                  </ul>\n                )}\n                \n                {nextOptions.length === 0 && !loadingNextOptions && (\n                  <div className=\"empty-options\">\n                    <p>没有找到合适的押韵句子</p>\n                    <button onClick={startNewGame}>重新开始</button>\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n\n          {/* 押韵记录 */}\n          <div className=\"game-log-section\">\n            <h2>押韵记录</h2>\n            {gameLog.length > 0 ? (\n              <ol className=\"game-log-list\">\n                {gameLog.map((log, index) => (\n                  <li key={index} className=\"log-item\">\n                    <div className=\"log-text\">{log.text}</div>\n                    <div className=\"log-info\">\n                      <span className=\"episode\">{formatEpisode(log.episode)}</span>\n                      <span className=\"time\">{formatTime(log.start_seconds)}</span>\n                      {log.clipUrl && (\n                        <span className=\"clip-info\">\n                          <i className=\"video-icon\">🎬</i>\n                        </span>\n                      )}\n                    </div>\n                  </li>\n                ))}\n              </ol>\n            ) : (\n              <div className=\"empty-log\">尚未开始游戏</div>\n            )}\n          </div>\n        </div>\n\n        {/* 右侧：视频预览区域 */}\n        <div className=\"game-video-preview\">\n          {isConfirmMode && (\n            <div className=\"confirm-section\">\n              <div className=\"selected-sentence\">\n                <div className=\"selected-text\">{selectedOption?.text}</div>\n                <div className=\"selected-info\">\n                  <span className=\"episode\">{formatEpisode(selectedOption?.episode)}</span>\n                  <span className=\"time\">{formatTime(selectedOption?.start_seconds)}</span>\n                </div>\n              </div>\n              \n              <div className=\"video-preview\">\n                {isVideoLoading ? (\n                  <div className=\"loading-video\">生成视频片段中，请稍候...</div>\n                ) : videoUrl ? (\n                  <video \n                    controls \n                    autoPlay \n                    className=\"video-element\"\n                    src={videoUrl}\n                  />\n                ) : (\n                  <div className=\"video-placeholder\">准备生成视频片段...</div>\n                )}\n              </div>\n              \n              <div className=\"confirm-buttons\">\n                <button \n                  className=\"confirm-btn\"\n                  onClick={gameStarted ? confirmNextSentence : confirmStartSentence}\n                  disabled={isVideoLoading || !videoUrl}\n                >\n                  确认选择\n                </button>\n                <button \n                  className=\"cancel-btn\"\n                  onClick={cancelSelection}\n                >\n                  取消选择\n                </button>\n              </div>\n            </div>\n          )}\n          {!isConfirmMode && (\n            <div className=\"video-section\">\n              <h2>视频预览</h2>\n              {isVideoLoading ? (\n                <div className=\"loading-video\">生成视频片段中，请稍候...</div>\n              ) : videoUrl ? (\n                <video \n                  controls \n                  autoPlay \n                  className=\"video-element\"\n                  src={videoUrl}\n                />\n              ) : (\n                <div className=\"video-placeholder large\">\n                  <div className=\"placeholder-text\">\n                    <p>请从左侧选择一个句子</p>\n                    <p>选择后将在此处预览视频</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// 奇妙对话组件\nconst DialogueGamePage = ({ \n  API_BASE_URL, \n  apiStatus,\n  formatTime,\n  formatEpisode,\n  availableDramas,\n  formatDramaName\n}) => {\n  const [gameStarted, setGameStarted] = useState(false);\n  const [currentPrompts, setCurrentPrompts] = useState([]);\n  const [loadingPrompts, setLoadingPrompts] = useState(false);\n  const [gameLog, setGameLog] = useState([]);\n  const [currentSentence, setCurrentSentence] = useState(null);\n  const [nextOptions, setNextOptions] = useState([]);\n  const [loadingNextOptions, setLoadingNextOptions] = useState(false);\n  const [gameError, setGameError] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(false);\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [isExportingVideo, setIsExportingVideo] = useState(false);\n  const [clipUrls, setClipUrls] = useState([]);\n  const [isConfirmMode, setIsConfirmMode] = useState(false);\n  const [selectedDramas, setSelectedDramas] = useState(\n    availableDramas ? availableDramas.map(drama => drama.id) : []\n  );\n\n  // 处理剧集选择变化\n  const handleDramaChange = (dramaId) => {\n    if (selectedDramas.includes(dramaId)) {\n      // 如果已经选中，则从数组中移除\n      setSelectedDramas(selectedDramas.filter(id => id !== dramaId));\n    } else {\n      // 如果未选中，则添加到数组\n      setSelectedDramas([...selectedDramas, dramaId]);\n    }\n  };\n\n  // 选择/取消选择所有剧集\n  const toggleAllDramas = () => {\n    if (selectedDramas.length === availableDramas.length) {\n      // 如果已选择所有剧集，则取消选择所有\n      setSelectedDramas([]);\n    } else {\n      // 选择所有剧集\n      setSelectedDramas(availableDramas.map(drama => drama.id));\n    }\n  };\n\n  // 获取随机提示句子\n  const fetchRandomPrompts = async () => {\n    if (selectedDramas.length === 0) {\n      setGameError('请至少选择一个剧集');\n      return;\n    }\n    \n    setLoadingPrompts(true);\n    setGameError(null);\n    \n    try {\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/random_sentences`, {\n        params: { \n          count: 8,\n          drama_ids: dramaIdsParam\n        }\n      });\n      \n      if (response.data && response.data.results) {\n        setCurrentPrompts(response.data.results);\n      } else {\n        setGameError('获取提示句子失败');\n      }\n    } catch (error) {\n      console.error('获取提示句子错误:', error);\n      setGameError('无法获取提示句子，请确保API服务正常运行');\n    } finally {\n      setLoadingPrompts(false);\n    }\n  };\n\n  // 刷新随机提示\n  const refreshRandomPrompts = () => {\n    if (apiStatus === 'connected' && !loadingPrompts) {\n      fetchRandomPrompts();\n    }\n  };\n\n  // 生成视频片段\n  const generateVideoClip = async (subtitle) => {\n    setIsVideoLoading(true);\n    setVideoUrl('');\n    setGameError(null);\n    \n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/generate_clip`, {\n        drama_id: subtitle.drama_id,\n        episode: subtitle.episode,\n        start_time: subtitle.start_seconds,\n        end_time: subtitle.end_seconds,\n        context_seconds: 2\n      });\n\n      if (response.data && response.data.clip_url) {\n        const clipUrl = `${API_BASE_URL}${response.data.clip_url}`;\n        setVideoUrl(clipUrl);\n        return clipUrl;\n      } else {\n        setGameError('生成视频片段失败');\n        return null;\n      }\n    } catch (error) {\n      console.error('生成视频片段出错:', error);\n      setGameError('视频服务出现错误，请确保视频文件存在且可访问');\n      return null;\n    } finally {\n      setIsVideoLoading(false);\n    }\n  };\n\n  // 选择开始句子\n  const selectStartSentence = (prompt) => {\n    setSelectedOption(prompt);\n    setIsConfirmMode(true);\n    generateVideoClip(prompt);\n  };\n\n  // 确认选择开始句子\n  const confirmStartSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    \n    setCurrentSentence(sentence);\n    setGameLog([{...sentence, step: 1, clipUrl: videoUrl}]);\n    setClipUrls([...clipUrls, videoUrl]);\n    setGameStarted(true);\n    fetchDialogueResponses(sentence);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 取消选择\n  const cancelSelection = () => {\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n    setVideoUrl('');\n  };\n  \n  // 选择下一个句子\n  const selectNextSentence = (option) => {\n    setSelectedOption(option);\n    setIsConfirmMode(true);\n    generateVideoClip(option);\n  };\n\n  // 确认选择下一个句子\n  const confirmNextSentence = () => {\n    const sentence = selectedOption;\n    if (!sentence) return;\n    \n    setCurrentSentence(sentence);\n    setGameLog([...gameLog, {...sentence, step: gameLog.length + 1, clipUrl: videoUrl}]);\n    setClipUrls([...clipUrls, videoUrl]);\n    fetchDialogueResponses(sentence);\n    setIsConfirmMode(false);\n    setSelectedOption(null);\n  };\n\n  // 获取对话回应选项\n  const fetchDialogueResponses = async (sentence) => {\n    if (!sentence) return;\n    \n    setLoadingNextOptions(true);\n    setGameError(null);\n    \n    try {\n      console.log(`正在查找对\"${sentence.text}\"的有趣回应...`);\n      \n      // 确保有选择的剧集\n      if (selectedDramas.length === 0) {\n        setGameError('请至少选择一个剧集');\n        setLoadingNextOptions(false);\n        return;\n      }\n      \n      // 调用后端API查询对话回应\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.post(`${API_BASE_URL}/api/dialogue_responses`, {\n        sentence_text: sentence.text,\n        episode: sentence.episode,\n        drama_ids: dramaIdsParam,\n        current_drama_id: sentence.drama_id\n      });\n      \n      if (response.data && response.data.results) {\n        console.log(`API返回了 ${response.data.results.length} 条对话回应`);\n        setNextOptions(response.data.results);\n      } else {\n        setGameError('获取对话回应失败：无结果返回');\n        setNextOptions([]);\n      }\n    } catch (error) {\n      console.error('获取对话回应错误:', error);\n      setGameError(`获取对话回应失败: ${error.message}`);\n      setNextOptions([]);\n    } finally {\n      setLoadingNextOptions(false);\n    }\n  };\n\n  // 获取最后一个有效字符（排除语气词）\n  const getLastValidChar = (text) => {\n    if (!text || text.length === 0) return null;\n    \n    // 排除常见语气词\n    const cleanText = text.replace(/[啊呢吗吧呀嘛哦哎嗯呐呵呦诶哈哟]$/, '');\n    return cleanText.length > 0 ? cleanText[cleanText.length - 1] : null;\n  };\n\n  // 刷新下一步选项\n  const refreshNextOptions = () => {\n    if (currentSentence && !loadingNextOptions) {\n      fetchDialogueResponses(currentSentence);\n    }\n  };\n\n  // 回到上一步\n  const goBackOneStep = () => {\n    if (gameLog.length <= 1) {\n      // 只有一步，回到选择开始句子\n      setGameStarted(false);\n      setGameLog([]);\n      setCurrentSentence(null);\n      setNextOptions([]);\n      setClipUrls([]);\n      setVideoUrl('');\n      fetchRandomPrompts();\n    } else {\n      // 移除最后一步\n      const newLog = [...gameLog];\n      newLog.pop();\n      setGameLog(newLog);\n      \n      // 更新当前句子和视频\n      const prevSentence = newLog[newLog.length - 1];\n      setCurrentSentence(prevSentence);\n      \n      // 更新剪辑URL列表\n      const newClipUrls = [...clipUrls];\n      newClipUrls.pop();\n      setClipUrls(newClipUrls);\n      \n      // 重新获取选项\n      fetchDialogueResponses(prevSentence);\n    }\n  };\n\n  // 合并视频并导出\n  const exportMergedVideo = async () => {\n    if (clipUrls.length === 0) return;\n    \n    setIsExportingVideo(true);\n    setGameError(null);\n    \n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/merge_clips`, {\n        clip_urls: clipUrls\n      });\n      \n      if (response.data && response.data.merged_url) {\n        const mergedVideoUrl = `${API_BASE_URL}${response.data.merged_url}`;\n        \n        // 创建下载链接\n        const link = document.createElement('a');\n        link.href = mergedVideoUrl;\n        link.download = '奇妙对话视频.mp4';\n        link.click();\n        \n        console.log('视频合并成功，已触发下载');\n      } else {\n        setGameError('视频合并失败: ' + (response.data.error || '未知错误'));\n      }\n    } catch (error) {\n      console.error('视频合并错误:', error);\n      setGameError('视频合并服务出错: ' + error.message);\n    } finally {\n      setIsExportingVideo(false);\n    }\n  };\n\n  // 开始新游戏\n  const startNewGame = () => {\n    setGameLog([]);\n    fetchRandomPrompts();\n    setGameStarted(false);\n    setCurrentSentence(null);\n    setNextOptions([]);\n    setClipUrls([]);\n    setVideoUrl('');\n    setSelectedOption(null);\n    setIsConfirmMode(false);\n  };\n\n  // 初始加载时获取随机提示\n  useEffect(() => {\n    if (apiStatus === 'connected') {\n      fetchRandomPrompts();\n    }\n  }, [apiStatus]);\n\n  return (\n    <div className=\"chain-game-container\">\n      <div className=\"drama-selector\">\n        <div className=\"drama-selector-header\">\n          <h3>选择剧集</h3>\n          <button \n            type=\"button\" \n            className=\"toggle-all-button\"\n            onClick={toggleAllDramas}\n          >\n            {selectedDramas.length === availableDramas.length ? '取消全选' : '全选'}\n          </button>\n        </div>\n        <div className=\"drama-checkbox-container\">\n          {availableDramas.map(drama => (\n            <div className=\"drama-checkbox\" key={drama.id}>\n              <input\n                type=\"checkbox\"\n                id={`dialogue-drama-${drama.id}`}\n                checked={selectedDramas.includes(drama.id)}\n                onChange={() => handleDramaChange(drama.id)}\n              />\n              <label htmlFor={`dialogue-drama-${drama.id}`}>\n                {formatDramaName(drama)}\n              </label>\n            </div>\n          ))}\n        </div>\n      </div>\n      \n      <div className=\"game-controls\">\n        <button \n          onClick={startNewGame}\n          className=\"new-game-btn\"\n          disabled={apiStatus !== 'connected'}\n        >\n          新游戏\n        </button>\n        \n        {gameLog.length > 0 && (\n          <>\n            <button \n              onClick={goBackOneStep}\n              className=\"back-btn\"\n              disabled={isConfirmMode}\n            >\n              上一步\n            </button>\n            \n            <button \n              onClick={exportMergedVideo}\n              className=\"export-btn\"\n              disabled={gameLog.length < 2 || isExportingVideo}\n            >\n              {isExportingVideo ? '导出中...' : '导出对话视频'}\n            </button>\n          </>\n        )}\n      </div>\n      \n      {gameError && (\n        <div className=\"game-error\">{gameError}</div>\n      )}\n      \n      <div className=\"game-content\">\n        {/* 左侧：候选词区域 */}\n        <div className=\"game-candidates\">\n          {!gameStarted ? (\n            <div className=\"start-game-section\">\n              <div className=\"section-header\">\n                <h2>选择开始句子</h2>\n                <button \n                  onClick={refreshRandomPrompts}\n                  className=\"refresh-btn\"\n                  disabled={loadingPrompts || apiStatus !== 'connected'}\n                >\n                  换一批\n                </button>\n              </div>\n              \n              {loadingPrompts ? (\n                <div className=\"loading\">加载提示句子中...</div>\n              ) : (\n                <ul className=\"prompts-list\">\n                  {currentPrompts.map((prompt, index) => (\n                    <li \n                      key={index} \n                      onClick={() => selectStartSentence(prompt)}\n                      className={selectedOption === prompt ? 'prompt-item selected' : 'prompt-item'}\n                    >\n                      <div className=\"prompt-text\">{prompt.text}</div>\n                      <div className=\"prompt-info\">\n                        <span className=\"episode\">{formatEpisode(prompt.episode)}</span>\n                        <span className=\"time\">{formatTime(prompt.start_seconds)}</span>\n                        <span className={`sentence-type ${analyzeSentenceType(prompt.text)}`}>{analyzeSentenceType(prompt.text)}</span>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              )}\n              \n              {currentPrompts.length === 0 && !loadingPrompts && (\n                <div className=\"empty-prompts\">\n                  <p>没有可用的提示句子</p>\n                  <button onClick={refreshRandomPrompts}>重新获取</button>\n                </div>\n              )}\n            </div>\n          ) : (\n            <>\n              <div className=\"current-sentence-section\">\n                <div className=\"section-header\">\n                  <h2>当前句子</h2>\n                </div>\n                \n                <div className=\"current-sentence\">\n                  <div className=\"sentence-text\">{currentSentence?.text}</div>\n                  <div className=\"sentence-info\">\n                    <span className=\"episode\">{formatEpisode(currentSentence?.episode)}</span>\n                    <span className=\"time\">{formatTime(currentSentence?.start_seconds)}</span>\n                  </div>\n                  <div className=\"sentence-type-tag\">\n                    <span className={analyzeSentenceType(currentSentence?.text)}>{analyzeSentenceType(currentSentence?.text)}</span>\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"next-options-section\">\n                <div className=\"section-header\">\n                  <h2>有趣回应</h2>\n                  <button \n                    onClick={refreshNextOptions}\n                    className=\"refresh-btn\"\n                    disabled={loadingNextOptions}\n                  >\n                    换一批\n                  </button>\n                </div>\n                \n                {loadingNextOptions ? (\n                  <div className=\"loading\">查找有趣回应中...</div>\n                ) : (\n                  <ul className=\"options-list\">\n                    {nextOptions.map((option, index) => (\n                      <li \n                        key={index}\n                        onClick={() => selectNextSentence(option)}\n                        className={selectedOption === option ? 'option-item selected' : 'option-item'}\n                      >\n                        <div className=\"option-text\">{option.text}</div>\n                        <div className=\"option-info\">\n                          <span className=\"episode\">{formatEpisode(option.episode)}</span>\n                          <span className=\"time\">{formatTime(option.start_seconds)}</span>\n                          <span className={`sentence-type ${analyzeSentenceType(option.text)}`}>{analyzeSentenceType(option.text)}</span>\n                        </div>\n                      </li>\n                    ))}\n                  </ul>\n                )}\n                \n                {nextOptions.length === 0 && !loadingNextOptions && (\n                  <div className=\"empty-options\">\n                    <p>没有找到合适的回应句子</p>\n                    <button onClick={startNewGame}>重新开始</button>\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n\n          {/* 对话记录 */}\n          <div className=\"game-log-section\">\n            <h2>对话记录</h2>\n            {gameLog.length > 0 ? (\n              <ol className=\"game-log-list\">\n                {gameLog.map((log, index) => (\n                  <li key={index} className=\"log-item\">\n                    <div className=\"log-text\">{log.text}</div>\n                    <div className=\"log-info\">\n                      <span className=\"episode\">{formatEpisode(log.episode)}</span>\n                      <span className=\"time\">{formatTime(log.start_seconds)}</span>\n                      {log.clipUrl && (\n                        <span className=\"clip-info\">\n                          <i className=\"video-icon\">🎬</i>\n                        </span>\n                      )}\n                    </div>\n                  </li>\n                ))}\n              </ol>\n            ) : (\n              <div className=\"empty-log\">尚未开始对话</div>\n            )}\n          </div>\n        </div>\n\n        {/* 右侧：视频预览区域 */}\n        <div className=\"game-video-preview\">\n          {isConfirmMode && (\n            <div className=\"confirm-section\">\n              <div className=\"selected-sentence\">\n                <div className=\"selected-text\">{selectedOption?.text}</div>\n                <div className=\"selected-info\">\n                  <span className=\"episode\">{formatEpisode(selectedOption?.episode)}</span>\n                  <span className=\"time\">{formatTime(selectedOption?.start_seconds)}</span>\n                </div>\n              </div>\n              \n              <div className=\"video-preview\">\n                {isVideoLoading ? (\n                  <div className=\"loading-video\">生成视频片段中，请稍候...</div>\n                ) : videoUrl ? (\n                  <video \n                    controls \n                    autoPlay \n                    className=\"video-element\"\n                    src={videoUrl}\n                  />\n                ) : (\n                  <div className=\"video-placeholder\">准备生成视频片段...</div>\n                )}\n              </div>\n              \n              <div className=\"confirm-buttons\">\n                <button \n                  className=\"confirm-btn\"\n                  onClick={gameStarted ? confirmNextSentence : confirmStartSentence}\n                  disabled={isVideoLoading || !videoUrl}\n                >\n                  确认选择\n                </button>\n                <button \n                  className=\"cancel-btn\"\n                  onClick={cancelSelection}\n                >\n                  取消选择\n                </button>\n              </div>\n            </div>\n          )}\n          {!isConfirmMode && (\n            <div className=\"video-section\">\n              <h2>视频预览</h2>\n              {isVideoLoading ? (\n                <div className=\"loading-video\">生成视频片段中，请稍候...</div>\n              ) : videoUrl ? (\n                <video \n                  controls \n                  autoPlay \n                  className=\"video-element\"\n                  src={videoUrl}\n                />\n              ) : (\n                <div className=\"video-placeholder large\">\n                  <div className=\"placeholder-text\">\n                    <p>请从左侧选择一个句子</p>\n                    <p>选择后将在此处预览视频</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// 分析句子类型 - 全局辅助函数\nconst analyzeSentenceType = (text) => {\n  if (!text) return '普通句';\n  \n  // 判断是否为问句\n  if (text.includes('?') || text.includes('？') || text.includes('吗') || text.includes('呢')) {\n    return '疑问句';\n  }\n  \n  // 判断是否为命令句\n  const commandWords = ['去', '来', '给我', '快', '立刻', '马上', '传'];\n  if (commandWords.some(word => text.includes(word))) {\n    return '命令句';\n  }\n  \n  // 判断情感色彩\n  const positiveWords = ['好', '愿意', '可以', '是', '对', '喜欢', '爱', '高兴'];\n  const negativeWords = ['不', '没', '别', '莫', '拒绝', '难过', '恨', '讨厌'];\n  \n  if (positiveWords.some(word => text.includes(word))) {\n    return '积极句';\n  }\n  \n  if (negativeWords.some(word => text.includes(word))) {\n    return '消极句';\n  }\n  \n  return '普通句';\n};\n\nfunction App() {\n  const API_BASE_URL = 'http://localhost:8089';\n  \n  // 搜索页面状态\n  const [query, setQuery] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [apiStatus, setApiStatus] = useState('unknown');\n  const [error, setError] = useState(null);\n  const [selectedResult, setSelectedResult] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(false);\n  const [currentPage, setCurrentPage] = useState('search');\n  \n  // 剧集相关状态\n  const [availableDramas, setAvailableDramas] = useState([]);\n  const [selectedDramas, setSelectedDramas] = useState([]);\n  const [dramaStats, setDramaStats] = useState({});\n\n  useEffect(() => {\n    checkApiStatus();\n  }, []);\n  \n  // 获取API状态并加载可用剧集\n  const checkApiStatus = async () => {\n    try {\n      const response = await axios.get(`${API_BASE_URL}/api/status`);\n      if (response.data && response.data.status === 'ok') {\n        setApiStatus('connected');\n        \n        // 保存剧集信息\n        if (response.data.dramas) {\n          setAvailableDramas(response.data.dramas);\n          // 默认选择所有可用剧集\n          setSelectedDramas(response.data.dramas.map(drama => drama.id));\n        }\n        \n        // 保存剧集统计信息\n        if (response.data.drama_stats) {\n          setDramaStats(response.data.drama_stats);\n        }\n      } else {\n        setApiStatus('error');\n        setError('API服务状态异常');\n      }\n    } catch (error) {\n      console.error('API状态检查错误:', error);\n      setApiStatus('disconnected');\n      setError('无法连接到API服务，请确保服务器已启动');\n    }\n  };\n\n  const handleSearch = async (e) => {\n    if (e) e.preventDefault();\n    if (apiStatus !== 'connected') return;\n    if (!query.trim()) {\n      setError('请输入搜索内容');\n      return;\n    }\n    if (selectedDramas.length === 0) {\n      setError('请至少选择一个剧集');\n      return;\n    }\n    \n    setLoading(true);\n    setError(null);\n    setSearchResults([]);\n    setSelectedResult(null);\n    setVideoUrl('');\n    \n    try {\n      const dramaIdsParam = selectedDramas.join(',');\n      const response = await axios.get(`${API_BASE_URL}/api/search`, {\n        params: {\n          query: query.trim(),\n          drama_ids: dramaIdsParam,\n          case_sensitive: false\n        }\n      });\n      \n      if (response.data && response.data.results) {\n        console.log(\"搜索结果:\", response.data.results);\n        setSearchResults(response.data.results);\n        if (response.data.results.length === 0) {\n          setError(`未找到匹配\"${query}\"的结果`);\n        }\n      } else {\n        setError('未获取到有效的搜索结果');\n      }\n    } catch (error) {\n      console.error('搜索错误:', error);\n      setError('搜索过程中出现错误，请重试');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleGenerateClip = async (result) => {\n    if (isVideoLoading) return;\n    \n    setSelectedResult(result);\n    setIsVideoLoading(true);\n    setVideoUrl('');\n    setError(null);\n    \n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/generate_clip`, {\n        drama_id: result.drama_id,\n        episode: result.episode,\n        start_time: result.start_seconds,\n        end_time: result.end_seconds,\n        context_seconds: 2\n      });\n      \n      if (response.data && response.data.clip_url) {\n        const url = `${API_BASE_URL}${response.data.clip_url}`;\n        setVideoUrl(url);\n      } else {\n        setError('无法生成视频片段');\n      }\n    } catch (error) {\n      console.error('生成视频片段失败:', error);\n      setError('请求失败，请检查网络连接');\n    } finally {\n      setIsVideoLoading(false);\n    }\n  };\n\n  const formatTime = (seconds) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const formatEpisode = (episode) => {\n    // 从集数名称中提取数字\n    const match = episode.match(/\\d+/);\n    if (match) {\n      return `第${match[0]}集`;\n    }\n    return episode;\n  };\n  \n  const formatDramaName = (drama) => {\n    // 根据drama_id获取剧名\n    if (!drama || !drama.id) return '未知剧集';\n    \n    // 如果传入的是完整drama对象，则直接返回名称\n    if (drama.name) return drama.name;\n    \n    // 否则在availableDramas中查找\n    const foundDrama = availableDramas.find(d => d.id === drama.id);\n    return foundDrama ? foundDrama.name : drama.id;\n  };\n\n  const highlightText = (text, query) => {\n    if (!query || !text) return text;\n    \n    // 简单的字符串替换，为匹配的文本添加高亮标签\n    const escapedQuery = query.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    const regex = new RegExp(escapedQuery, 'gi');\n    return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`);\n  };\n\n  const switchPage = (page) => {\n    setCurrentPage(page);\n    setError(null);\n  };\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <h1>字幕搜索系统</h1>\n        \n        <div className=\"api-status\">\n          API服务状态: \n          {apiStatus === 'connected' ? (\n            <span className=\"status-connected\">已连接</span>\n          ) : apiStatus === 'disconnected' ? (\n            <span className=\"status-disconnected\">未连接</span>\n          ) : (\n            <span className=\"status-checking\">检查中...</span>\n          )}\n        </div>\n        \n        <nav className=\"main-nav\">\n          <ul>\n            <li className={currentPage === 'search' ? 'active' : ''}>\n              <button onClick={() => switchPage('search')}>字幕搜索</button>\n            </li>\n            <li className={currentPage === 'chain-game' ? 'active' : ''}>\n              <button onClick={() => switchPage('chain-game')}>字幕接龙</button>\n            </li>\n            <li className={currentPage === 'rhyme-game' ? 'active' : ''}>\n              <button onClick={() => switchPage('rhyme-game')}>字幕押韵</button>\n            </li>\n            <li className={currentPage === 'dialogue-game' ? 'active' : ''}>\n              <button onClick={() => switchPage('dialogue-game')}>奇妙对话</button>\n            </li>\n          </ul>\n        </nav>\n      </header>\n      \n      <main className=\"App-main\">\n        {currentPage === 'search' && (\n          <SearchPage \n            API_BASE_URL={API_BASE_URL}\n            query={query}\n            setQuery={setQuery}\n            searchResults={searchResults}\n            setSearchResults={setSearchResults}\n            loading={loading}\n            setLoading={setLoading}\n            apiStatus={apiStatus}\n            error={error}\n            setError={setError}\n            selectedResult={selectedResult}\n            setSelectedResult={setSelectedResult}\n            videoUrl={videoUrl}\n            setVideoUrl={setVideoUrl}\n            isVideoLoading={isVideoLoading}\n            setIsVideoLoading={setIsVideoLoading}\n            handleSearch={handleSearch}\n            handleGenerateClip={handleGenerateClip}\n            formatTime={formatTime}\n            formatEpisode={formatEpisode}\n            highlightText={highlightText}\n            availableDramas={availableDramas}\n            selectedDramas={selectedDramas}\n            setSelectedDramas={setSelectedDramas}\n            formatDramaName={formatDramaName}\n          />\n        )}\n        \n        {currentPage === 'chain-game' && (\n          <ChainGamePage \n            API_BASE_URL={API_BASE_URL}\n            apiStatus={apiStatus}\n            formatTime={formatTime}\n            formatEpisode={formatEpisode}\n            availableDramas={availableDramas}\n            formatDramaName={formatDramaName}\n          />\n        )}\n        \n        {currentPage === 'rhyme-game' && (\n          <RhymeGamePage \n            API_BASE_URL={API_BASE_URL}\n            apiStatus={apiStatus}\n            formatTime={formatTime}\n            formatEpisode={formatEpisode}\n            availableDramas={availableDramas}\n            formatDramaName={formatDramaName}\n          />\n        )}\n        \n        {currentPage === 'dialogue-game' && (\n          <DialogueGamePage \n            API_BASE_URL={API_BASE_URL}\n            apiStatus={apiStatus}\n            formatTime={formatTime}\n            formatEpisode={formatEpisode}\n            availableDramas={availableDramas}\n            formatDramaName={formatDramaName}\n          />\n        )}\n      </main>\n      \n      <footer className=\"App-footer\">\n        <p>字幕搜索系统 &copy; 2023</p>\n      </footer>\n    </div>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}